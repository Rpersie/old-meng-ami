Setting up environment...
Environment set up.
Training deep multidecoder...
Constructing model...
Done constructing model.
DNNMultidecoder (
  (activation): SELU
  (encoder): Sequential (
    (lin_0): Linear (880 -> 2048)
    (bn_0): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (lin_1): Linear (2048 -> 2048)
    (bn_1): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (lin_2): Linear (2048 -> 2048)
    (bn_2): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True)
    (SELU_2): SELU
    (lin_final): Linear (2048 -> 1024)
  )
  (decoder_ihm): Sequential (
    (lin_0): Linear (1024 -> 2048)
    (SELU_0): SELU
    (lin_1): Linear (2048 -> 2048)
    (SELU_1): SELU
    (lin_2): Linear (2048 -> 2048)
    (SELU_2): SELU
    (lin_final): Linear (2048 -> 880)
  )
  (decoder_sdm1): Sequential (
    (lin_0): Linear (1024 -> 2048)
    (SELU_0): SELU
    (lin_1): Linear (2048 -> 2048)
    (SELU_1): SELU
    (lin_2): Linear (2048 -> 2048)
    (SELU_2): SELU
    (lin_final): Linear (2048 -> 880)
  )
)
Setting up data...
Setting up training datasets...
Using 2407138 training features (9403 batches) for class ihm
Using 2407138 training features (9403 batches) for class sdm1
Setting up dev datasets...
Using 249565 dev features (975 batches) for class ihm
Using 249565 dev features (975 batches) for class sdm1
Setting up minibatch shuffling for training...
18806 total batches: {'ihm': 9403, 'sdm1': 9403}
Done setting up data.
Starting training!
Train epoch 1: [1000/18806 (5.3%)]	Loss: 0.203915
Train epoch 1: [2000/18806 (10.6%)]	Loss: 0.171116
Train epoch 1: [3000/18806 (16.0%)]	Loss: 0.187325
Train epoch 1: [4000/18806 (21.3%)]	Loss: 0.182582
Train epoch 1: [5000/18806 (26.6%)]	Loss: 0.173452
Train epoch 1: [6000/18806 (31.9%)]	Loss: 0.166217
Train epoch 1: [7000/18806 (37.2%)]	Loss: 0.159522
Train epoch 1: [8000/18806 (42.5%)]	Loss: 0.156816
Train epoch 1: [9000/18806 (47.9%)]	Loss: 0.153164
Train epoch 1: [10000/18806 (53.2%)]	Loss: 0.151485
Train epoch 1: [11000/18806 (58.5%)]	Loss: 0.149421
Train epoch 1: [12000/18806 (63.8%)]	Loss: 0.146252
Train epoch 1: [13000/18806 (69.1%)]	Loss: 0.141907
Train epoch 1: [14000/18806 (74.4%)]	Loss: 0.137628
Train epoch 1: [15000/18806 (79.8%)]	Loss: 0.136103
Train epoch 1: [16000/18806 (85.1%)]	Loss: 0.136535
Train epoch 1: [17000/18806 (90.4%)]	Loss: 0.135335
Train epoch 1: [18000/18806 (95.7%)]	Loss: 0.134883
====> Epoch 1: Average train loss 0.134733
====> Dev set loss: 0.099675
New best dev set loss: 0.099675
Saved checkpoint for model
Train epoch 2: [1000/18806 (5.3%)]	Loss: 0.099406
Train epoch 2: [2000/18806 (10.6%)]	Loss: 0.085690
Train epoch 2: [3000/18806 (16.0%)]	Loss: 0.099474
Train epoch 2: [4000/18806 (21.3%)]	Loss: 0.100414
Train epoch 2: [5000/18806 (26.6%)]	Loss: 0.098065
Train epoch 2: [6000/18806 (31.9%)]	Loss: 0.095560
Train epoch 2: [7000/18806 (37.2%)]	Loss: 0.092962
Train epoch 2: [8000/18806 (42.5%)]	Loss: 0.093838
Train epoch 2: [9000/18806 (47.9%)]	Loss: 0.093437
Train epoch 2: [10000/18806 (53.2%)]	Loss: 0.093478
Train epoch 2: [11000/18806 (58.5%)]	Loss: 0.092949
Train epoch 2: [12000/18806 (63.8%)]	Loss: 0.091817
Train epoch 2: [13000/18806 (69.1%)]	Loss: 0.089724
Train epoch 2: [14000/18806 (74.4%)]	Loss: 0.087580
Train epoch 2: [15000/18806 (79.8%)]	Loss: 0.087219
Train epoch 2: [16000/18806 (85.1%)]	Loss: 0.088602
Train epoch 2: [17000/18806 (90.4%)]	Loss: 0.088493
Train epoch 2: [18000/18806 (95.7%)]	Loss: 0.088786
====> Epoch 2: Average train loss 0.089294
====> Dev set loss: 0.102598
No improvement in 1 epochs (best dev set loss: 0.099675)
Not saving checkpoint; no improvement made
Train epoch 3: [1000/18806 (5.3%)]	Loss: 0.076257
Train epoch 3: [2000/18806 (10.6%)]	Loss: 0.066869
Train epoch 3: [3000/18806 (16.0%)]	Loss: 0.077457
Train epoch 3: [4000/18806 (21.3%)]	Loss: 0.079533
Train epoch 3: [5000/18806 (26.6%)]	Loss: 0.078160
Train epoch 3: [6000/18806 (31.9%)]	Loss: 0.076605
Train epoch 3: [7000/18806 (37.2%)]	Loss: 0.075137
Train epoch 3: [8000/18806 (42.5%)]	Loss: 0.076492
Train epoch 3: [9000/18806 (47.9%)]	Loss: 0.076505
Train epoch 3: [10000/18806 (53.2%)]	Loss: 0.077323
Train epoch 3: [11000/18806 (58.5%)]	Loss: 0.076899
Train epoch 3: [12000/18806 (63.8%)]	Loss: 0.076278
Train epoch 3: [13000/18806 (69.1%)]	Loss: 0.074627
Train epoch 3: [14000/18806 (74.4%)]	Loss: 0.073031
Train epoch 3: [15000/18806 (79.8%)]	Loss: 0.072877
Train epoch 3: [16000/18806 (85.1%)]	Loss: 0.074242
Train epoch 3: [17000/18806 (90.4%)]	Loss: 0.074313
Train epoch 3: [18000/18806 (95.7%)]	Loss: 0.074726
====> Epoch 3: Average train loss 0.075323
====> Dev set loss: 0.092650
New best dev set loss: 0.092650
Saved checkpoint for model
Train epoch 4: [1000/18806 (5.3%)]	Loss: 0.067748
Train epoch 4: [2000/18806 (10.6%)]	Loss: 0.060611
Train epoch 4: [3000/18806 (16.0%)]	Loss: 0.069072
Train epoch 4: [4000/18806 (21.3%)]	Loss: 0.070556
Train epoch 4: [5000/18806 (26.6%)]	Loss: 0.069426
Train epoch 4: [6000/18806 (31.9%)]	Loss: 0.068318
Train epoch 4: [7000/18806 (37.2%)]	Loss: 0.066988
Train epoch 4: [8000/18806 (42.5%)]	Loss: 0.068111
Train epoch 4: [9000/18806 (47.9%)]	Loss: 0.068232
Train epoch 4: [10000/18806 (53.2%)]	Loss: 0.069270
Train epoch 4: [11000/18806 (58.5%)]	Loss: 0.069000
Train epoch 4: [12000/18806 (63.8%)]	Loss: 0.068400
Train epoch 4: [13000/18806 (69.1%)]	Loss: 0.067156
Train epoch 4: [14000/18806 (74.4%)]	Loss: 0.065824
Train epoch 4: [15000/18806 (79.8%)]	Loss: 0.065755
Train epoch 4: [16000/18806 (85.1%)]	Loss: 0.067376
Train epoch 4: [17000/18806 (90.4%)]	Loss: 0.067366
Train epoch 4: [18000/18806 (95.7%)]	Loss: 0.067665
====> Epoch 4: Average train loss 0.068291
====> Dev set loss: 0.097987
No improvement in 1 epochs (best dev set loss: 0.092650)
Not saving checkpoint; no improvement made
Train epoch 5: [1000/18806 (5.3%)]	Loss: 0.061954
Train epoch 5: [2000/18806 (10.6%)]	Loss: 0.056105
Train epoch 5: [3000/18806 (16.0%)]	Loss: 0.065058
Train epoch 5: [4000/18806 (21.3%)]	Loss: 0.066236
Train epoch 5: [5000/18806 (26.6%)]	Loss: 0.065461
Train epoch 5: [6000/18806 (31.9%)]	Loss: 0.064405
Train epoch 5: [7000/18806 (37.2%)]	Loss: 0.063188
Train epoch 5: [8000/18806 (42.5%)]	Loss: 0.064467
Train epoch 5: [9000/18806 (47.9%)]	Loss: 0.064535
Train epoch 5: [10000/18806 (53.2%)]	Loss: 0.065306
Train epoch 5: [11000/18806 (58.5%)]	Loss: 0.064885
Train epoch 5: [12000/18806 (63.8%)]	Loss: 0.064287
Train epoch 5: [13000/18806 (69.1%)]	Loss: 0.063202
Train epoch 5: [14000/18806 (74.4%)]	Loss: 0.061982
Train epoch 5: [15000/18806 (79.8%)]	Loss: 0.061869
Train epoch 5: [16000/18806 (85.1%)]	Loss: 0.063353
Train epoch 5: [17000/18806 (90.4%)]	Loss: 0.063432
Train epoch 5: [18000/18806 (95.7%)]	Loss: 0.063786
====> Epoch 5: Average train loss 0.064300
====> Dev set loss: 0.096713
No improvement in 2 epochs (best dev set loss: 0.092650)
Not saving checkpoint; no improvement made
Train epoch 6: [1000/18806 (5.3%)]	Loss: 0.057381
Train epoch 6: [2000/18806 (10.6%)]	Loss: 0.052510
Train epoch 6: [3000/18806 (16.0%)]	Loss: 0.060851
Train epoch 6: [4000/18806 (21.3%)]	Loss: 0.062503
Train epoch 6: [5000/18806 (26.6%)]	Loss: 0.061539
Train epoch 6: [6000/18806 (31.9%)]	Loss: 0.060623
Train epoch 6: [7000/18806 (37.2%)]	Loss: 0.059606
Train epoch 6: [8000/18806 (42.5%)]	Loss: 0.060894
Train epoch 6: [9000/18806 (47.9%)]	Loss: 0.061181
Train epoch 6: [10000/18806 (53.2%)]	Loss: 0.061982
Train epoch 6: [11000/18806 (58.5%)]	Loss: 0.061784
Train epoch 6: [12000/18806 (63.8%)]	Loss: 0.061373
Train epoch 6: [13000/18806 (69.1%)]	Loss: 0.060206
Train epoch 6: [14000/18806 (74.4%)]	Loss: 0.059079
Train epoch 6: [15000/18806 (79.8%)]	Loss: 0.058955
Train epoch 6: [16000/18806 (85.1%)]	Loss: 0.060343
Train epoch 6: [17000/18806 (90.4%)]	Loss: 0.060438
Train epoch 6: [18000/18806 (95.7%)]	Loss: 0.060754
====> Epoch 6: Average train loss 0.061266
====> Dev set loss: 0.098436
No improvement in 3 epochs (best dev set loss: 0.092650)
STOPPING EARLY
Trained deep multidecoder.
