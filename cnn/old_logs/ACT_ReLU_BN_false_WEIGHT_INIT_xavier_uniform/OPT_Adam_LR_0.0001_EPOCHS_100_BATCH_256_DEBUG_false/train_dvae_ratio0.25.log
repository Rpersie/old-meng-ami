Running training with mode dvae
Noising 25.000% of input features
Constructing model...
Done constructing model.
CNNVariationalMultidecoder (
  (encoder_conv): Sequential (
    (conv2d_0): Conv2d(1, 256, kernel_size=(3, 3), stride=(1, 1))
    (ReLU_0): ReLU ()
    (maxpool2d_0): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
    (conv2d_1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1))
    (ReLU_1): ReLU ()
    (maxpool2d_1): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
  )
  (encoder_fc): Sequential (
    (lin_0): Linear (14336 -> 2048)
    (ReLU_0): ReLU ()
  )
  (decoder_fc_ihm): Sequential (
    (lin_0): Linear (1024 -> 2048)
    (ReLU_0): ReLU ()
    (lin_final): Linear (2048 -> 14336)
    (ReLU_final): ReLU ()
  )
  (decoder_deconv_ihm): Sequential (
    (maxunpool2d_0): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ReLU_0): ReLU ()
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(256, 1, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ReLU_1): ReLU ()
  )
  (decoder_fc_sdm1): Sequential (
    (lin_0): Linear (1024 -> 2048)
    (ReLU_0): ReLU ()
    (lin_final): Linear (2048 -> 14336)
    (ReLU_final): ReLU ()
  )
  (decoder_deconv_sdm1): Sequential (
    (maxunpool2d_0): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ReLU_0): ReLU ()
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(256, 1, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ReLU_1): ReLU ()
  )
  (latent_mu): Sequential (
    (lin): Linear (2048 -> 1024)
    (ReLU): ReLU ()
  )
  (latent_logvar): Sequential (
    (lin): Linear (2048 -> 1024)
    (ReLU): ReLU ()
  )
)
Setting up data...
Setting up training datasets...
Using 2407138 training features (9403 batches) for class ihm
Using 2407138 training features (9403 batches) for class sdm1
Setting up dev datasets...
Using 249565 dev features (975 batches) for class ihm
Using 249565 dev features (975 batches) for class sdm1
Setting up minibatch shuffling for training...
18806 total batches: {'ihm': 9403, 'sdm1': 9403}
Done setting up data.
Completed setup in 165.050 seconds
Starting training!
Train epoch 1: [1000/18806 (5.3%)]	RL: 0.855120, KL: 0.000894 (total 0.856014)
Train epoch 1: [2000/18806 (10.6%)]	RL: 0.826401, KL: 0.000569 (total 0.826970)
Train epoch 1: [3000/18806 (16.0%)]	RL: 0.805011, KL: 0.000452 (total 0.805463)
Train epoch 1: [4000/18806 (21.3%)]	RL: 0.788858, KL: 0.000387 (total 0.789245)
Train epoch 1: [5000/18806 (26.6%)]	RL: 0.773395, KL: 0.000344 (total 0.773740)
Train epoch 1: [6000/18806 (31.9%)]	RL: 0.768902, KL: 0.000316 (total 0.769218)
Train epoch 1: [7000/18806 (37.2%)]	RL: 0.766702, KL: 0.000295 (total 0.766997)
Train epoch 1: [8000/18806 (42.5%)]	RL: 0.762033, KL: 0.000276 (total 0.762309)
Train epoch 1: [9000/18806 (47.9%)]	RL: 0.760414, KL: 0.000261 (total 0.760675)
Train epoch 1: [10000/18806 (53.2%)]	RL: 0.757875, KL: 0.000249 (total 0.758123)
Train epoch 1: [11000/18806 (58.5%)]	RL: 0.755847, KL: 0.000238 (total 0.756085)
Train epoch 1: [12000/18806 (63.8%)]	RL: 0.753323, KL: 0.000229 (total 0.753552)
Train epoch 1: [13000/18806 (69.1%)]	RL: 0.752228, KL: 0.000222 (total 0.752449)
Train epoch 1: [14000/18806 (74.4%)]	RL: 0.749797, KL: 0.000215 (total 0.750012)
Train epoch 1: [15000/18806 (79.8%)]	RL: 0.748757, KL: 0.000210 (total 0.748967)
Train epoch 1: [16000/18806 (85.1%)]	RL: 0.746563, KL: 0.000205 (total 0.746768)
Train epoch 1: [17000/18806 (90.4%)]	RL: 0.744696, KL: 0.000200 (total 0.744897)
Train epoch 1: [18000/18806 (95.7%)]	RL: 0.743257, KL: 0.000196 (total 0.743453)
====> Epoch 1 (3835.391s): Average train RL 0.743, KL 0.000 (total 0.743) (['ihm: 0.777', 'sdm1: 0.708'])
====> Dev set (153.017s) RL 0.810, KL 0.000 (total 0.811) (['ihm: 0.803', 'sdm1: 0.818'])
New best dev set loss: 0.810598
Saved checkpoint for model
Train epoch 2: [1000/18806 (5.3%)]	RL: 0.694255, KL: 0.000119 (total 0.694374)
Train epoch 2: [2000/18806 (10.6%)]	RL: 0.699994, KL: 0.000116 (total 0.700110)
Train epoch 2: [3000/18806 (16.0%)]	RL: 0.707384, KL: 0.000115 (total 0.707499)
Train epoch 2: [4000/18806 (21.3%)]	RL: 0.709319, KL: 0.000114 (total 0.709433)
Train epoch 2: [5000/18806 (26.6%)]	RL: 0.705901, KL: 0.000114 (total 0.706015)
Train epoch 2: [6000/18806 (31.9%)]	RL: 0.709841, KL: 0.000113 (total 0.709954)
Train epoch 2: [7000/18806 (37.2%)]	RL: 0.713421, KL: 0.000113 (total 0.713534)
Train epoch 2: [8000/18806 (42.5%)]	RL: 0.712156, KL: 0.000113 (total 0.712269)
Train epoch 2: [9000/18806 (47.9%)]	RL: 0.713735, KL: 0.000113 (total 0.713848)
Train epoch 2: [10000/18806 (53.2%)]	RL: 0.713603, KL: 0.000113 (total 0.713716)
Train epoch 2: [11000/18806 (58.5%)]	RL: 0.713261, KL: 0.000113 (total 0.713374)
Train epoch 2: [12000/18806 (63.8%)]	RL: 0.713186, KL: 0.000113 (total 0.713298)
Train epoch 2: [13000/18806 (69.1%)]	RL: 0.713980, KL: 0.000112 (total 0.714092)
Train epoch 2: [14000/18806 (74.4%)]	RL: 0.713494, KL: 0.000112 (total 0.713606)
Train epoch 2: [15000/18806 (79.8%)]	RL: 0.713918, KL: 0.000112 (total 0.714030)
Train epoch 2: [16000/18806 (85.1%)]	RL: 0.713117, KL: 0.000112 (total 0.713229)
Train epoch 2: [17000/18806 (90.4%)]	RL: 0.712382, KL: 0.000112 (total 0.712494)
Train epoch 2: [18000/18806 (95.7%)]	RL: 0.712005, KL: 0.000112 (total 0.712117)
====> Epoch 2 (3817.065s): Average train RL 0.712, KL 0.000 (total 0.712) (['ihm: 0.742', 'sdm1: 0.683'])
====> Dev set (151.819s) RL 0.745, KL 0.000 (total 0.745) (['ihm: 0.727', 'sdm1: 0.764'])
New best dev set loss: 0.745448
Saved checkpoint for model
Train epoch 3: [1000/18806 (5.3%)]	RL: 0.685242, KL: 0.000107 (total 0.685349)
Train epoch 3: [2000/18806 (10.6%)]	RL: 0.689114, KL: 0.000107 (total 0.689221)
Train epoch 3: [3000/18806 (16.0%)]	RL: 0.696830, KL: 0.000107 (total 0.696937)
Train epoch 3: [4000/18806 (21.3%)]	RL: 0.698639, KL: 0.000107 (total 0.698746)
Train epoch 3: [5000/18806 (26.6%)]	RL: 0.696132, KL: 0.000107 (total 0.696239)
Train epoch 3: [6000/18806 (31.9%)]	RL: 0.700731, KL: 0.000107 (total 0.700837)
Train epoch 3: [7000/18806 (37.2%)]	RL: 0.703290, KL: 0.000107 (total 0.703397)
Train epoch 3: [8000/18806 (42.5%)]	RL: 0.702723, KL: 0.000107 (total 0.702830)
Train epoch 3: [9000/18806 (47.9%)]	RL: 0.704363, KL: 0.000107 (total 0.704470)
Train epoch 3: [10000/18806 (53.2%)]	RL: 0.704544, KL: 0.000107 (total 0.704651)
Train epoch 3: [11000/18806 (58.5%)]	RL: 0.704472, KL: 0.000107 (total 0.704579)
Train epoch 3: [12000/18806 (63.8%)]	RL: 0.704225, KL: 0.000107 (total 0.704332)
Train epoch 3: [13000/18806 (69.1%)]	RL: 0.705077, KL: 0.000107 (total 0.705184)
Train epoch 3: [14000/18806 (74.4%)]	RL: 0.704875, KL: 0.000107 (total 0.704982)
Train epoch 3: [15000/18806 (79.8%)]	RL: 0.705405, KL: 0.000107 (total 0.705512)
Train epoch 3: [16000/18806 (85.1%)]	RL: 0.704860, KL: 0.000107 (total 0.704967)
Train epoch 3: [17000/18806 (90.4%)]	RL: 0.704457, KL: 0.000107 (total 0.704564)
Train epoch 3: [18000/18806 (95.7%)]	RL: 0.704175, KL: 0.000107 (total 0.704282)
====> Epoch 3 (3818.633s): Average train RL 0.704, KL 0.000 (total 0.705) (['ihm: 0.734', 'sdm1: 0.675'])
====> Dev set (151.905s) RL 0.720, KL 0.000 (total 0.721) (['ihm: 0.716', 'sdm1: 0.725'])
New best dev set loss: 0.720579
Saved checkpoint for model
Train epoch 4: [1000/18806 (5.3%)]	RL: 0.679397, KL: 0.000107 (total 0.679504)
Train epoch 4: [2000/18806 (10.6%)]	RL: 0.683728, KL: 0.000107 (total 0.683835)
Train epoch 4: [3000/18806 (16.0%)]	RL: 0.690018, KL: 0.000107 (total 0.690124)
Train epoch 4: [4000/18806 (21.3%)]	RL: 0.693505, KL: 0.000107 (total 0.693612)
Train epoch 4: [5000/18806 (26.6%)]	RL: 0.691025, KL: 0.000107 (total 0.691132)
Train epoch 4: [6000/18806 (31.9%)]	RL: 0.694892, KL: 0.000107 (total 0.694999)
Train epoch 4: [7000/18806 (37.2%)]	RL: 0.698751, KL: 0.000107 (total 0.698858)
Train epoch 4: [8000/18806 (42.5%)]	RL: 0.697837, KL: 0.000107 (total 0.697943)
Train epoch 4: [9000/18806 (47.9%)]	RL: 0.699808, KL: 0.000107 (total 0.699915)
Train epoch 4: [10000/18806 (53.2%)]	RL: 0.700021, KL: 0.000107 (total 0.700128)
Train epoch 4: [11000/18806 (58.5%)]	RL: 0.699828, KL: 0.000107 (total 0.699935)
Train epoch 4: [12000/18806 (63.8%)]	RL: 0.700006, KL: 0.000107 (total 0.700113)
Train epoch 4: [13000/18806 (69.1%)]	RL: 0.701188, KL: 0.000107 (total 0.701295)
Train epoch 4: [14000/18806 (74.4%)]	RL: 0.700495, KL: 0.000107 (total 0.700602)
Train epoch 4: [15000/18806 (79.8%)]	RL: 0.701040, KL: 0.000107 (total 0.701146)
Train epoch 4: [16000/18806 (85.1%)]	RL: 0.700520, KL: 0.000107 (total 0.700627)
Train epoch 4: [17000/18806 (90.4%)]	RL: 0.700085, KL: 0.000107 (total 0.700192)
Train epoch 4: [18000/18806 (95.7%)]	RL: 0.699821, KL: 0.000107 (total 0.699928)
====> Epoch 4 (3814.760s): Average train RL 0.700, KL 0.000 (total 0.700) (['ihm: 0.731', 'sdm1: 0.669'])
====> Dev set (153.801s) RL 0.706, KL 0.000 (total 0.706) (['ihm: 0.712', 'sdm1: 0.700'])
New best dev set loss: 0.706100
Saved checkpoint for model
Train epoch 5: [1000/18806 (5.3%)]	RL: 0.675738, KL: 0.000107 (total 0.675845)
Train epoch 5: [2000/18806 (10.6%)]	RL: 0.681015, KL: 0.000107 (total 0.681122)
Train epoch 5: [3000/18806 (16.0%)]	RL: 0.687212, KL: 0.000107 (total 0.687319)
Train epoch 5: [4000/18806 (21.3%)]	RL: 0.690169, KL: 0.000107 (total 0.690276)
Train epoch 5: [5000/18806 (26.6%)]	RL: 0.688089, KL: 0.000107 (total 0.688196)
Train epoch 5: [6000/18806 (31.9%)]	RL: 0.692401, KL: 0.000107 (total 0.692508)
Train epoch 5: [7000/18806 (37.2%)]	RL: 0.695870, KL: 0.000107 (total 0.695977)
Train epoch 5: [8000/18806 (42.5%)]	RL: 0.695215, KL: 0.000107 (total 0.695322)
Train epoch 5: [9000/18806 (47.9%)]	RL: 0.697017, KL: 0.000107 (total 0.697124)
Train epoch 5: [10000/18806 (53.2%)]	RL: 0.697280, KL: 0.000107 (total 0.697387)
Train epoch 5: [11000/18806 (58.5%)]	RL: 0.697101, KL: 0.000107 (total 0.697208)
Train epoch 5: [12000/18806 (63.8%)]	RL: 0.697143, KL: 0.000107 (total 0.697250)
Train epoch 5: [13000/18806 (69.1%)]	RL: 0.698326, KL: 0.000107 (total 0.698432)
Train epoch 5: [14000/18806 (74.4%)]	RL: 0.697505, KL: 0.000107 (total 0.697612)
Train epoch 5: [15000/18806 (79.8%)]	RL: 0.698268, KL: 0.000107 (total 0.698375)
Train epoch 5: [16000/18806 (85.1%)]	RL: 0.697506, KL: 0.000107 (total 0.697613)
Train epoch 5: [17000/18806 (90.4%)]	RL: 0.696983, KL: 0.000107 (total 0.697090)
Train epoch 5: [18000/18806 (95.7%)]	RL: 0.696741, KL: 0.000107 (total 0.696847)
====> Epoch 5 (3817.425s): Average train RL 0.697, KL 0.000 (total 0.697) (['ihm: 0.731', 'sdm1: 0.664'])
====> Dev set (153.491s) RL 0.686, KL 0.000 (total 0.686) (['ihm: 0.710', 'sdm1: 0.662'])
New best dev set loss: 0.686016
Saved checkpoint for model
Train epoch 6: [1000/18806 (5.3%)]	RL: 0.669122, KL: 0.000107 (total 0.669229)
Train epoch 6: [2000/18806 (10.6%)]	RL: 0.678126, KL: 0.000107 (total 0.678232)
Train epoch 6: [3000/18806 (16.0%)]	RL: 0.684178, KL: 0.000107 (total 0.684285)
Train epoch 6: [4000/18806 (21.3%)]	RL: 0.686197, KL: 0.000107 (total 0.686303)
Train epoch 6: [5000/18806 (26.6%)]	RL: 0.683943, KL: 0.000107 (total 0.684050)
Train epoch 6: [6000/18806 (31.9%)]	RL: 0.687834, KL: 0.000107 (total 0.687941)
Train epoch 6: [7000/18806 (37.2%)]	RL: 0.691403, KL: 0.000107 (total 0.691510)
Train epoch 6: [8000/18806 (42.5%)]	RL: 0.690803, KL: 0.000107 (total 0.690910)
Train epoch 6: [9000/18806 (47.9%)]	RL: 0.692129, KL: 0.000107 (total 0.692236)
Train epoch 6: [10000/18806 (53.2%)]	RL: 0.692403, KL: 0.000107 (total 0.692510)
Train epoch 6: [11000/18806 (58.5%)]	RL: 0.692465, KL: 0.000107 (total 0.692572)
Train epoch 6: [12000/18806 (63.8%)]	RL: 0.692587, KL: 0.000107 (total 0.692694)
Train epoch 6: [13000/18806 (69.1%)]	RL: 0.693432, KL: 0.000107 (total 0.693538)
Train epoch 6: [14000/18806 (74.4%)]	RL: 0.693139, KL: 0.000107 (total 0.693246)
Train epoch 6: [15000/18806 (79.8%)]	RL: 0.693671, KL: 0.000107 (total 0.693778)
Train epoch 6: [16000/18806 (85.1%)]	RL: 0.693429, KL: 0.000107 (total 0.693536)
Train epoch 6: [17000/18806 (90.4%)]	RL: 0.692909, KL: 0.000107 (total 0.693016)
Train epoch 6: [18000/18806 (95.7%)]	RL: 0.692785, KL: 0.000107 (total 0.692891)
====> Epoch 6 (3818.903s): Average train RL 0.693, KL 0.000 (total 0.693) (['ihm: 0.730', 'sdm1: 0.656'])
====> Dev set (151.008s) RL 0.677, KL 0.000 (total 0.677) (['ihm: 0.708', 'sdm1: 0.646'])
New best dev set loss: 0.676865
Saved checkpoint for model
Train epoch 7: [1000/18806 (5.3%)]	RL: 0.667288, KL: 0.000107 (total 0.667394)
Train epoch 7: [2000/18806 (10.6%)]	RL: 0.675060, KL: 0.000107 (total 0.675167)
Train epoch 7: [3000/18806 (16.0%)]	RL: 0.683047, KL: 0.000107 (total 0.683154)
Train epoch 7: [4000/18806 (21.3%)]	RL: 0.683979, KL: 0.000107 (total 0.684085)
Train epoch 7: [5000/18806 (26.6%)]	RL: 0.681764, KL: 0.000107 (total 0.681871)
Train epoch 7: [6000/18806 (31.9%)]	RL: 0.686244, KL: 0.000107 (total 0.686351)
Train epoch 7: [7000/18806 (37.2%)]	RL: 0.689421, KL: 0.000107 (total 0.689528)
Train epoch 7: [8000/18806 (42.5%)]	RL: 0.688491, KL: 0.000107 (total 0.688598)
Train epoch 7: [9000/18806 (47.9%)]	RL: 0.690608, KL: 0.000107 (total 0.690714)
Train epoch 7: [10000/18806 (53.2%)]	RL: 0.690792, KL: 0.000107 (total 0.690899)
Train epoch 7: [11000/18806 (58.5%)]	RL: 0.690644, KL: 0.000107 (total 0.690751)
Train epoch 7: [12000/18806 (63.8%)]	RL: 0.690744, KL: 0.000107 (total 0.690851)
Train epoch 7: [13000/18806 (69.1%)]	RL: 0.692237, KL: 0.000107 (total 0.692344)
Train epoch 7: [14000/18806 (74.4%)]	RL: 0.691731, KL: 0.000107 (total 0.691838)
Train epoch 7: [15000/18806 (79.8%)]	RL: 0.692590, KL: 0.000107 (total 0.692696)
Train epoch 7: [16000/18806 (85.1%)]	RL: 0.691955, KL: 0.000107 (total 0.692062)
Train epoch 7: [17000/18806 (90.4%)]	RL: 0.691340, KL: 0.000107 (total 0.691447)
Train epoch 7: [18000/18806 (95.7%)]	RL: 0.691051, KL: 0.000107 (total 0.691158)
====> Epoch 7 (2724.315s): Average train RL 0.691, KL 0.000 (total 0.691) (['ihm: 0.730', 'sdm1: 0.653'])
====> Dev set (106.877s) RL 0.673, KL 0.000 (total 0.673) (['ihm: 0.707', 'sdm1: 0.639'])
New best dev set loss: 0.672986
Saved checkpoint for model
Train epoch 8: [1000/18806 (5.3%)]	RL: 0.665382, KL: 0.000107 (total 0.665489)
Train epoch 8: [2000/18806 (10.6%)]	RL: 0.675187, KL: 0.000107 (total 0.675294)
Train epoch 8: [3000/18806 (16.0%)]	RL: 0.681954, KL: 0.000107 (total 0.682060)
Train epoch 8: [4000/18806 (21.3%)]	RL: 0.682457, KL: 0.000107 (total 0.682564)
Train epoch 8: [5000/18806 (26.6%)]	RL: 0.680843, KL: 0.000107 (total 0.680949)
Train epoch 8: [6000/18806 (31.9%)]	RL: 0.684759, KL: 0.000107 (total 0.684866)
Train epoch 8: [7000/18806 (37.2%)]	RL: 0.688087, KL: 0.000107 (total 0.688194)
Train epoch 8: [8000/18806 (42.5%)]	RL: 0.687311, KL: 0.000107 (total 0.687418)
Train epoch 8: [9000/18806 (47.9%)]	RL: 0.689329, KL: 0.000107 (total 0.689435)
Train epoch 8: [10000/18806 (53.2%)]	RL: 0.689591, KL: 0.000107 (total 0.689697)
Train epoch 8: [11000/18806 (58.5%)]	RL: 0.689981, KL: 0.000107 (total 0.690087)
Train epoch 8: [12000/18806 (63.8%)]	RL: 0.689926, KL: 0.000107 (total 0.690033)
Train epoch 8: [13000/18806 (69.1%)]	RL: 0.691118, KL: 0.000107 (total 0.691225)
Train epoch 8: [14000/18806 (74.4%)]	RL: 0.690428, KL: 0.000107 (total 0.690535)
Train epoch 8: [15000/18806 (79.8%)]	RL: 0.691264, KL: 0.000107 (total 0.691371)
Train epoch 8: [16000/18806 (85.1%)]	RL: 0.690786, KL: 0.000107 (total 0.690893)
Train epoch 8: [17000/18806 (90.4%)]	RL: 0.690239, KL: 0.000107 (total 0.690346)
Train epoch 8: [18000/18806 (95.7%)]	RL: 0.689985, KL: 0.000107 (total 0.690092)
====> Epoch 8 (2338.915s): Average train RL 0.690, KL 0.000 (total 0.690) (['ihm: 0.730', 'sdm1: 0.651'])
====> Dev set (99.340s) RL 0.671, KL 0.000 (total 0.671) (['ihm: 0.706', 'sdm1: 0.637'])
New best dev set loss: 0.671212
Saved checkpoint for model
Train epoch 9: [1000/18806 (5.3%)]	RL: 0.666448, KL: 0.000107 (total 0.666555)
Train epoch 9: [2000/18806 (10.6%)]	RL: 0.672743, KL: 0.000107 (total 0.672849)
Train epoch 9: [3000/18806 (16.0%)]	RL: 0.679338, KL: 0.000107 (total 0.679445)
