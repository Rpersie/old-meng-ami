Setting up environment...
Environment set up.
Training convolutional multidecoder...
Constructing model...
Done constructing model.
CNNMultidecoder (
  (encoder_conv): Sequential (
    (conv2d_0): Conv2d(1, 256, kernel_size=(3, 3), stride=(1, 1))
    (batchnorm2d_0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (maxpool2d_0): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
    (conv2d_1): Conv2d(256, 128, kernel_size=(3, 3), stride=(1, 1))
    (batchnorm2d_1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (maxpool2d_1): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
    (conv2d_2): Conv2d(128, 64, kernel_size=(3, 3), stride=(1, 1))
    (batchnorm2d_2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True)
    (SELU_2): SELU
  )
  (encoder_fc): Sequential (
    (lin_0): Linear (1920 -> 1024)
    (SELU_0): SELU
    (lin_1): Linear (1024 -> 1024)
    (SELU_1): SELU
    (lin_final): Linear (1024 -> 1024)
  )
  (decoder_fc_ihm): Sequential (
    (lin_0): Linear (1024 -> 1024)
    (SELU_0): SELU
    (lin_1): Linear (1024 -> 1024)
    (SELU_1): SELU
    (lin_final): Linear (1024 -> 1920)
  )
  (decoder_deconv_ihm): Sequential (
    (conv2d_0): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (maxunpool2d_2): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_2): Conv2d(256, 1, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_2): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True)
    (SELU_2): SELU
  )
  (decoder_fc_sdm1): Sequential (
    (lin_0): Linear (1024 -> 1024)
    (SELU_0): SELU
    (lin_1): Linear (1024 -> 1024)
    (SELU_1): SELU
    (lin_final): Linear (1024 -> 1920)
  )
  (decoder_deconv_sdm1): Sequential (
    (conv2d_0): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (maxunpool2d_2): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_2): Conv2d(256, 1, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_2): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True)
    (SELU_2): SELU
  )
)
Setting up data...
Setting up training datasets...
Using 2407138 training features (9403 batches) for class ihm
Using 2407138 training features (9403 batches) for class sdm1
Setting up dev datasets...
Using 249565 dev features (975 batches) for class ihm
Using 249565 dev features (975 batches) for class sdm1
Setting up minibatch shuffling for training...
18806 total batches: {'ihm': 9403, 'sdm1': 9403}
Done setting up data.
Starting training!
Train epoch 1: [1000/18806 (5.3%)]	Loss: 0.749871
Train epoch 1: [2000/18806 (10.6%)]	Loss: 0.641202
Train epoch 1: [3000/18806 (16.0%)]	Loss: 0.564243
Train epoch 1: [4000/18806 (21.3%)]	Loss: 0.514740
Train epoch 1: [5000/18806 (26.6%)]	Loss: 0.466487
Train epoch 1: [6000/18806 (31.9%)]	Loss: 0.426361
Train epoch 1: [7000/18806 (37.2%)]	Loss: 0.388991
Train epoch 1: [8000/18806 (42.5%)]	Loss: 0.364509
Train epoch 1: [9000/18806 (47.9%)]	Loss: 0.360097
Train epoch 1: [10000/18806 (53.2%)]	Loss: 0.353885
Train epoch 1: [11000/18806 (58.5%)]	Loss: 0.373430
Train epoch 1: [12000/18806 (63.8%)]	Loss: 0.393083
Train epoch 1: [13000/18806 (69.1%)]	Loss: 0.421857
Train epoch 1: [14000/18806 (74.4%)]	Loss: 0.451391
Train epoch 1: [15000/18806 (79.8%)]	Loss: 0.483334
Train epoch 1: [16000/18806 (85.1%)]	Loss: 0.513570
Train epoch 1: [17000/18806 (90.4%)]	Loss: 0.495171
Train epoch 1: [18000/18806 (95.7%)]	Loss: 0.477282
====> Epoch 1: Average train loss 0.462603
====> Dev set loss: 0.054193
New best dev set loss: 0.054193
Saved checkpoint for model
Train epoch 2: [1000/18806 (5.3%)]	Loss: 0.477845
Train epoch 2: [2000/18806 (10.6%)]	Loss: 0.447735
Train epoch 2: [3000/18806 (16.0%)]	Loss: 0.404068
Train epoch 2: [4000/18806 (21.3%)]	Loss: 0.377934
Train epoch 2: [5000/18806 (26.6%)]	Loss: 0.345912
Train epoch 2: [6000/18806 (31.9%)]	Loss: 0.320260
Train epoch 2: [7000/18806 (37.2%)]	Loss: 0.293981
Train epoch 2: [8000/18806 (42.5%)]	Loss: 0.277760
Train epoch 2: [9000/18806 (47.9%)]	Loss: 0.279754
Train epoch 2: [10000/18806 (53.2%)]	Loss: 0.279035
Train epoch 2: [11000/18806 (58.5%)]	Loss: 0.303796
Train epoch 2: [12000/18806 (63.8%)]	Loss: 0.327891
Train epoch 2: [13000/18806 (69.1%)]	Loss: 0.360375
Train epoch 2: [14000/18806 (74.4%)]	Loss: 0.396024
Train epoch 2: [15000/18806 (79.8%)]	Loss: 0.428932
Train epoch 2: [16000/18806 (85.1%)]	Loss: 0.461220
Train epoch 2: [17000/18806 (90.4%)]	Loss: 0.444780
Train epoch 2: [18000/18806 (95.7%)]	Loss: 0.428822
====> Epoch 2: Average train loss 0.415815
====> Dev set loss: 0.046857
New best dev set loss: 0.046857
Saved checkpoint for model
Train epoch 3: [1000/18806 (5.3%)]	Loss: 0.454799
Train epoch 3: [2000/18806 (10.6%)]	Loss: 0.425306
Train epoch 3: [3000/18806 (16.0%)]	Loss: 0.385907
Train epoch 3: [4000/18806 (21.3%)]	Loss: 0.361033
Train epoch 3: [5000/18806 (26.6%)]	Loss: 0.331024
Train epoch 3: [6000/18806 (31.9%)]	Loss: 0.306351
Train epoch 3: [7000/18806 (37.2%)]	Loss: 0.281279
Train epoch 3: [8000/18806 (42.5%)]	Loss: 0.265076
Train epoch 3: [9000/18806 (47.9%)]	Loss: 0.267796
Train epoch 3: [10000/18806 (53.2%)]	Loss: 0.267812
Train epoch 3: [11000/18806 (58.5%)]	Loss: 0.292136
Train epoch 3: [12000/18806 (63.8%)]	Loss: 0.316928
Train epoch 3: [13000/18806 (69.1%)]	Loss: 0.350067
Train epoch 3: [14000/18806 (74.4%)]	Loss: 0.385271
Train epoch 3: [15000/18806 (79.8%)]	Loss: 0.420372
Train epoch 3: [16000/18806 (85.1%)]	Loss: 0.450975
Train epoch 3: [17000/18806 (90.4%)]	Loss: 0.434826
Train epoch 3: [18000/18806 (95.7%)]	Loss: 0.419176
====> Epoch 3: Average train loss 0.406400
====> Dev set loss: 0.042506
New best dev set loss: 0.042506
Saved checkpoint for model
Train epoch 4: [1000/18806 (5.3%)]	Loss: 0.447206
Train epoch 4: [2000/18806 (10.6%)]	Loss: 0.420890
Train epoch 4: [3000/18806 (16.0%)]	Loss: 0.377273
Train epoch 4: [4000/18806 (21.3%)]	Loss: 0.355625
Train epoch 4: [5000/18806 (26.6%)]	Loss: 0.326429
Train epoch 4: [6000/18806 (31.9%)]	Loss: 0.301159
Train epoch 4: [7000/18806 (37.2%)]	Loss: 0.276233
Train epoch 4: [8000/18806 (42.5%)]	Loss: 0.260924
Train epoch 4: [9000/18806 (47.9%)]	Loss: 0.263411
Train epoch 4: [10000/18806 (53.2%)]	Loss: 0.263357
Train epoch 4: [11000/18806 (58.5%)]	Loss: 0.288366
Train epoch 4: [12000/18806 (63.8%)]	Loss: 0.312937
Train epoch 4: [13000/18806 (69.1%)]	Loss: 0.345564
Train epoch 4: [14000/18806 (74.4%)]	Loss: 0.380297
Train epoch 4: [15000/18806 (79.8%)]	Loss: 0.416260
Train epoch 4: [16000/18806 (85.1%)]	Loss: 0.446205
Train epoch 4: [17000/18806 (90.4%)]	Loss: 0.430414
Train epoch 4: [18000/18806 (95.7%)]	Loss: 0.414578
====> Epoch 4: Average train loss 0.401848
====> Dev set loss: 0.042233
New best dev set loss: 0.042233
Saved checkpoint for model
Train epoch 5: [1000/18806 (5.3%)]	Loss: 0.445278
Train epoch 5: [2000/18806 (10.6%)]	Loss: 0.417309
Train epoch 5: [3000/18806 (16.0%)]	Loss: 0.373904
Train epoch 5: [4000/18806 (21.3%)]	Loss: 0.352442
Train epoch 5: [5000/18806 (26.6%)]	Loss: 0.321994
Train epoch 5: [6000/18806 (31.9%)]	Loss: 0.298456
Train epoch 5: [7000/18806 (37.2%)]	Loss: 0.273589
Train epoch 5: [8000/18806 (42.5%)]	Loss: 0.258228
Train epoch 5: [9000/18806 (47.9%)]	Loss: 0.259633
Train epoch 5: [10000/18806 (53.2%)]	Loss: 0.260287
Train epoch 5: [11000/18806 (58.5%)]	Loss: 0.285786
Train epoch 5: [12000/18806 (63.8%)]	Loss: 0.309601
Train epoch 5: [13000/18806 (69.1%)]	Loss: 0.342040
Train epoch 5: [14000/18806 (74.4%)]	Loss: 0.376510
Train epoch 5: [15000/18806 (79.8%)]	Loss: 0.410255
Train epoch 5: [16000/18806 (85.1%)]	Loss: 0.441795
Train epoch 5: [17000/18806 (90.4%)]	Loss: 0.425948
Train epoch 5: [18000/18806 (95.7%)]	Loss: 0.410431
====> Epoch 5: Average train loss 0.397806
====> Dev set loss: 0.040971
New best dev set loss: 0.040971
Saved checkpoint for model
Train epoch 6: [1000/18806 (5.3%)]	Loss: 0.440005
Train epoch 6: [2000/18806 (10.6%)]	Loss: 0.408278
Train epoch 6: [3000/18806 (16.0%)]	Loss: 0.370591
Train epoch 6: [4000/18806 (21.3%)]	Loss: 0.346396
Train epoch 6: [5000/18806 (26.6%)]	Loss: 0.317690
Train epoch 6: [6000/18806 (31.9%)]	Loss: 0.292922
Train epoch 6: [7000/18806 (37.2%)]	Loss: 0.268765
Train epoch 6: [8000/18806 (42.5%)]	Loss: 0.253560
Train epoch 6: [9000/18806 (47.9%)]	Loss: 0.254195
Train epoch 6: [10000/18806 (53.2%)]	Loss: 0.255120
Train epoch 6: [11000/18806 (58.5%)]	Loss: 0.278818
Train epoch 6: [12000/18806 (63.8%)]	Loss: 0.304541
Train epoch 6: [13000/18806 (69.1%)]	Loss: 0.337045
Train epoch 6: [14000/18806 (74.4%)]	Loss: 0.371537
Train epoch 6: [15000/18806 (79.8%)]	Loss: 0.406896
Train epoch 6: [16000/18806 (85.1%)]	Loss: 0.436110
Train epoch 6: [17000/18806 (90.4%)]	Loss: 0.420528
Train epoch 6: [18000/18806 (95.7%)]	Loss: 0.405085
====> Epoch 6: Average train loss 0.392540
====> Dev set loss: 0.037922
New best dev set loss: 0.037922
Saved checkpoint for model
Train epoch 7: [1000/18806 (5.3%)]	Loss: 0.434398
Train epoch 7: [2000/18806 (10.6%)]	Loss: 0.405091
Train epoch 7: [3000/18806 (16.0%)]	Loss: 0.368419
Train epoch 7: [4000/18806 (21.3%)]	Loss: 0.343037
Train epoch 7: [5000/18806 (26.6%)]	Loss: 0.314293
Train epoch 7: [6000/18806 (31.9%)]	Loss: 0.290776
Train epoch 7: [7000/18806 (37.2%)]	Loss: 0.266073
Train epoch 7: [8000/18806 (42.5%)]	Loss: 0.251137
Train epoch 7: [9000/18806 (47.9%)]	Loss: 0.252647
Train epoch 7: [10000/18806 (53.2%)]	Loss: 0.253084
Train epoch 7: [11000/18806 (58.5%)]	Loss: 0.277436
Train epoch 7: [12000/18806 (63.8%)]	Loss: 0.300871
Train epoch 7: [13000/18806 (69.1%)]	Loss: 0.333499
Train epoch 7: [14000/18806 (74.4%)]	Loss: 0.366415
Train epoch 7: [15000/18806 (79.8%)]	Loss: 0.399759
Train epoch 7: [16000/18806 (85.1%)]	Loss: 0.431616
Train epoch 7: [17000/18806 (90.4%)]	Loss: 0.416062
Train epoch 7: [18000/18806 (95.7%)]	Loss: 0.400896
====> Epoch 7: Average train loss 0.388460
====> Dev set loss: 0.036300
New best dev set loss: 0.036300
Saved checkpoint for model
Train epoch 8: [1000/18806 (5.3%)]	Loss: 0.431967
Train epoch 8: [2000/18806 (10.6%)]	Loss: 0.401892
Train epoch 8: [3000/18806 (16.0%)]	Loss: 0.364555
Train epoch 8: [4000/18806 (21.3%)]	Loss: 0.340511
Train epoch 8: [5000/18806 (26.6%)]	Loss: 0.312453
Train epoch 8: [6000/18806 (31.9%)]	Loss: 0.287865
Train epoch 8: [7000/18806 (37.2%)]	Loss: 0.263410
Train epoch 8: [8000/18806 (42.5%)]	Loss: 0.248417
Train epoch 8: [9000/18806 (47.9%)]	Loss: 0.251053
Train epoch 8: [10000/18806 (53.2%)]	Loss: 0.251333
Train epoch 8: [11000/18806 (58.5%)]	Loss: 0.275902
Train epoch 8: [12000/18806 (63.8%)]	Loss: 0.298972
Train epoch 8: [13000/18806 (69.1%)]	Loss: 0.330404
Train epoch 8: [14000/18806 (74.4%)]	Loss: 0.363422
Train epoch 8: [15000/18806 (79.8%)]	Loss: 0.396132
Train epoch 8: [16000/18806 (85.1%)]	Loss: 0.427308
Train epoch 8: [17000/18806 (90.4%)]	Loss: 0.411832
Train epoch 8: [18000/18806 (95.7%)]	Loss: 0.396782
====> Epoch 8: Average train loss 0.384462
====> Dev set loss: 0.035171
New best dev set loss: 0.035171
Saved checkpoint for model
Train epoch 9: [1000/18806 (5.3%)]	Loss: 0.427681
Train epoch 9: [2000/18806 (10.6%)]	Loss: 0.399109
Train epoch 9: [3000/18806 (16.0%)]	Loss: 0.360977
Train epoch 9: [4000/18806 (21.3%)]	Loss: 0.337707
Train epoch 9: [5000/18806 (26.6%)]	Loss: 0.309856
Train epoch 9: [6000/18806 (31.9%)]	Loss: 0.285848
Train epoch 9: [7000/18806 (37.2%)]	Loss: 0.261280
Train epoch 9: [8000/18806 (42.5%)]	Loss: 0.246619
Train epoch 9: [9000/18806 (47.9%)]	Loss: 0.248901
Train epoch 9: [10000/18806 (53.2%)]	Loss: 0.249265
Train epoch 9: [11000/18806 (58.5%)]	Loss: 0.272814
Train epoch 9: [12000/18806 (63.8%)]	Loss: 0.295031
Train epoch 9: [13000/18806 (69.1%)]	Loss: 0.326774
Train epoch 9: [14000/18806 (74.4%)]	Loss: 0.360637
Train epoch 9: [15000/18806 (79.8%)]	Loss: 0.394185
Train epoch 9: [16000/18806 (85.1%)]	Loss: 0.423505
Train epoch 9: [17000/18806 (90.4%)]	Loss: 0.408247
Train epoch 9: [18000/18806 (95.7%)]	Loss: 0.393261
====> Epoch 9: Average train loss 0.380976
====> Dev set loss: 0.033942
New best dev set loss: 0.033942
Saved checkpoint for model
Train epoch 10: [1000/18806 (5.3%)]	Loss: 0.423900
Train epoch 10: [2000/18806 (10.6%)]	Loss: 0.395311
Train epoch 10: [3000/18806 (16.0%)]	Loss: 0.358531
Train epoch 10: [4000/18806 (21.3%)]	Loss: 0.333943
Train epoch 10: [5000/18806 (26.6%)]	Loss: 0.306648
Train epoch 10: [6000/18806 (31.9%)]	Loss: 0.282454
Train epoch 10: [7000/18806 (37.2%)]	Loss: 0.259186
Train epoch 10: [8000/18806 (42.5%)]	Loss: 0.244148
Train epoch 10: [9000/18806 (47.9%)]	Loss: 0.244349
Train epoch 10: [10000/18806 (53.2%)]	Loss: 0.244718
Train epoch 10: [11000/18806 (58.5%)]	Loss: 0.268427
Train epoch 10: [12000/18806 (63.8%)]	Loss: 0.292402
Train epoch 10: [13000/18806 (69.1%)]	Loss: 0.323655
Train epoch 10: [14000/18806 (74.4%)]	Loss: 0.357049
Train epoch 10: [15000/18806 (79.8%)]	Loss: 0.391042
Train epoch 10: [16000/18806 (85.1%)]	Loss: 0.419534
Train epoch 10: [17000/18806 (90.4%)]	Loss: 0.404285
Train epoch 10: [18000/18806 (95.7%)]	Loss: 0.389413
====> Epoch 10: Average train loss 0.377206
====> Dev set loss: 0.034546
No improvement in 1 epochs (best dev set loss: 0.033942)
Not saving checkpoint; no improvement made
Train epoch 11: [1000/18806 (5.3%)]	Loss: 0.416997
Train epoch 11: [2000/18806 (10.6%)]	Loss: 0.393209
Train epoch 11: [3000/18806 (16.0%)]	Loss: 0.353154
Train epoch 11: [4000/18806 (21.3%)]	Loss: 0.331922
Train epoch 11: [5000/18806 (26.6%)]	Loss: 0.303796
Train epoch 11: [6000/18806 (31.9%)]	Loss: 0.280307
Train epoch 11: [7000/18806 (37.2%)]	Loss: 0.256241
Train epoch 11: [8000/18806 (42.5%)]	Loss: 0.241676
Train epoch 11: [9000/18806 (47.9%)]	Loss: 0.243993
Train epoch 11: [10000/18806 (53.2%)]	Loss: 0.243765
Train epoch 11: [11000/18806 (58.5%)]	Loss: 0.266945
Train epoch 11: [12000/18806 (63.8%)]	Loss: 0.289013
Train epoch 11: [13000/18806 (69.1%)]	Loss: 0.320227
Train epoch 11: [14000/18806 (74.4%)]	Loss: 0.352935
Train epoch 11: [15000/18806 (79.8%)]	Loss: 0.384681
Train epoch 11: [16000/18806 (85.1%)]	Loss: 0.415335
Train epoch 11: [17000/18806 (90.4%)]	Loss: 0.400331
Train epoch 11: [18000/18806 (95.7%)]	Loss: 0.385592
====> Epoch 11: Average train loss 0.373469
====> Dev set loss: 0.035132
No improvement in 2 epochs (best dev set loss: 0.033942)
Not saving checkpoint; no improvement made
Train epoch 12: [1000/18806 (5.3%)]	Loss: 0.418645
Train epoch 12: [2000/18806 (10.6%)]	Loss: 0.388538
Train epoch 12: [3000/18806 (16.0%)]	Loss: 0.352386
Train epoch 12: [4000/18806 (21.3%)]	Loss: 0.328854
Train epoch 12: [5000/18806 (26.6%)]	Loss: 0.300566
Train epoch 12: [6000/18806 (31.9%)]	Loss: 0.277550
Train epoch 12: [7000/18806 (37.2%)]	Loss: 0.254054
Train epoch 12: [8000/18806 (42.5%)]	Loss: 0.239466
Train epoch 12: [9000/18806 (47.9%)]	Loss: 0.241622
Train epoch 12: [10000/18806 (53.2%)]	Loss: 0.241165
Train epoch 12: [11000/18806 (58.5%)]	Loss: 0.265132
Train epoch 12: [12000/18806 (63.8%)]	Loss: 0.286171
Train epoch 12: [13000/18806 (69.1%)]	Loss: 0.317040
Train epoch 12: [14000/18806 (74.4%)]	Loss: 0.350331
Train epoch 12: [15000/18806 (79.8%)]	Loss: 0.381812
Train epoch 12: [16000/18806 (85.1%)]	Loss: 0.411304
Train epoch 12: [17000/18806 (90.4%)]	Loss: 0.396333
Train epoch 12: [18000/18806 (95.7%)]	Loss: 0.381813
====> Epoch 12: Average train loss 0.369863
====> Dev set loss: 0.034709
No improvement in 3 epochs (best dev set loss: 0.033942)
STOPPING EARLY
Trained convolutional multidecoder.
