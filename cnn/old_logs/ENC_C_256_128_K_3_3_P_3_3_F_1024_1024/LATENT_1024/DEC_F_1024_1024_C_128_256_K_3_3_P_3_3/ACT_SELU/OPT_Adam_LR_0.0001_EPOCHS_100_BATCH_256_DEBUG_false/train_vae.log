Setting up environment...
Environment set up.
Training convolutional variational multidecoder...
Constructing model...
Done constructing model.
CNNVariationalMultidecoder (
  (encoder_conv): Sequential (
    (conv2d_0): Conv2d(1, 256, kernel_size=(3, 3), stride=(1, 1))
    (batchnorm2d_0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (maxpool2d_0): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
    (conv2d_1): Conv2d(256, 128, kernel_size=(3, 3), stride=(1, 1))
    (batchnorm2d_1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (maxpool2d_1): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
  )
  (encoder_fc): Sequential (
    (lin_0): Linear (7168 -> 1024)
    (batchnorm1d_0): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (lin_1): Linear (1024 -> 1024)
    (batchnorm1d_1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
  )
  (latent_mu): Sequential (
    (lin): Linear (1024 -> 1024)
    (SELU): SELU
  )
  (latent_logvar): Sequential (
    (lin): Linear (1024 -> 1024)
    (SELU): SELU
  )
  (decoder_fc_ihm): Sequential (
    (lin_0): Linear (1024 -> 1024)
    (batchnorm1d_0): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (lin_1): Linear (1024 -> 1024)
    (batchnorm1d_1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (lin_final): Linear (1024 -> 7168)
    (SELU_final): SELU
  )
  (decoder_deconv_ihm): Sequential (
    (maxunpool2d_0): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_0): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(256, 1, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_1): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
  )
  (decoder_fc_sdm1): Sequential (
    (lin_0): Linear (1024 -> 1024)
    (batchnorm1d_0): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (lin_1): Linear (1024 -> 1024)
    (batchnorm1d_1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (lin_final): Linear (1024 -> 7168)
    (SELU_final): SELU
  )
  (decoder_deconv_sdm1): Sequential (
    (maxunpool2d_0): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_0): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(256, 1, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_1): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
  )
)
Setting up data...
Setting up training datasets...
Using 2407138 training features (9403 batches) for class ihm
Using 2407138 training features (9403 batches) for class sdm1
Setting up dev datasets...
Using 249565 dev features (975 batches) for class ihm
Using 249565 dev features (975 batches) for class sdm1
Setting up minibatch shuffling for training...
18806 total batches: {'ihm': 9403, 'sdm1': 9403}
Done setting up data.
Starting training!
Train epoch 1: [1000/18806 (5.3%)]	Loss: 0.810817
Train epoch 1: [2000/18806 (10.6%)]	Loss: 0.695582
Train epoch 1: [3000/18806 (16.0%)]	Loss: 0.639396
Train epoch 1: [4000/18806 (21.3%)]	Loss: 0.581805
Train epoch 1: [5000/18806 (26.6%)]	Loss: 0.530761
Train epoch 1: [6000/18806 (31.9%)]	Loss: 0.490197
Train epoch 1: [7000/18806 (37.2%)]	Loss: 0.458153
Train epoch 1: [8000/18806 (42.5%)]	Loss: 0.434279
Train epoch 1: [9000/18806 (47.9%)]	Loss: 0.421814
Train epoch 1: [10000/18806 (53.2%)]	Loss: 0.428091
Train epoch 1: [11000/18806 (58.5%)]	Loss: 0.473968
Train epoch 1: [12000/18806 (63.8%)]	Loss: 0.508271
Train epoch 1: [13000/18806 (69.1%)]	Loss: 0.538736
Train epoch 1: [14000/18806 (74.4%)]	Loss: 0.562835
Train epoch 1: [15000/18806 (79.8%)]	Loss: 0.584213
Train epoch 1: [16000/18806 (85.1%)]	Loss: 0.604662
Train epoch 1: [17000/18806 (90.4%)]	Loss: 0.592573
Train epoch 1: [18000/18806 (95.7%)]	Loss: 0.578987
====> Epoch 1: Average train loss 0.565812
====> Dev set loss: 0.214126
New best dev set loss: 0.214126
Saved checkpoint for model
Train epoch 2: [1000/18806 (5.3%)]	Loss: 0.678141
Train epoch 2: [2000/18806 (10.6%)]	Loss: 0.606686
Train epoch 2: [3000/18806 (16.0%)]	Loss: 0.550519
Train epoch 2: [4000/18806 (21.3%)]	Loss: 0.505101
Train epoch 2: [5000/18806 (26.6%)]	Loss: 0.459922
Train epoch 2: [6000/18806 (31.9%)]	Loss: 0.424711
Train epoch 2: [7000/18806 (37.2%)]	Loss: 0.394419
Train epoch 2: [8000/18806 (42.5%)]	Loss: 0.373680
Train epoch 2: [9000/18806 (47.9%)]	Loss: 0.365132
Train epoch 2: [10000/18806 (53.2%)]	Loss: 0.370257
Train epoch 2: [11000/18806 (58.5%)]	Loss: 0.412255
Train epoch 2: [12000/18806 (63.8%)]	Loss: 0.442998
Train epoch 2: [13000/18806 (69.1%)]	Loss: 0.471430
Train epoch 2: [14000/18806 (74.4%)]	Loss: 0.496267
Train epoch 2: [15000/18806 (79.8%)]	Loss: 0.515241
Train epoch 2: [16000/18806 (85.1%)]	Loss: 0.535289
Train epoch 2: [17000/18806 (90.4%)]	Loss: 0.527104
Train epoch 2: [18000/18806 (95.7%)]	Loss: 0.516689
====> Epoch 2: Average train loss 0.505284
====> Dev set loss: 0.211893
New best dev set loss: 0.211893
Saved checkpoint for model
Train epoch 3: [1000/18806 (5.3%)]	Loss: 0.695950
Train epoch 3: [2000/18806 (10.6%)]	Loss: 0.618077
Train epoch 3: [3000/18806 (16.0%)]	Loss: 0.553718
Train epoch 3: [4000/18806 (21.3%)]	Loss: 0.505943
Train epoch 3: [5000/18806 (26.6%)]	Loss: 0.459754
Train epoch 3: [6000/18806 (31.9%)]	Loss: 0.423235
Train epoch 3: [7000/18806 (37.2%)]	Loss: 0.391829
Train epoch 3: [8000/18806 (42.5%)]	Loss: 0.369568
Train epoch 3: [9000/18806 (47.9%)]	Loss: 0.360357
Train epoch 3: [10000/18806 (53.2%)]	Loss: 0.364386
Train epoch 3: [11000/18806 (58.5%)]	Loss: 0.402052
Train epoch 3: [12000/18806 (63.8%)]	Loss: 0.430489
Train epoch 3: [13000/18806 (69.1%)]	Loss: 0.457523
Train epoch 3: [14000/18806 (74.4%)]	Loss: 0.480558
Train epoch 3: [15000/18806 (79.8%)]	Loss: 0.500005
Train epoch 3: [16000/18806 (85.1%)]	Loss: 0.518081
Train epoch 3: [17000/18806 (90.4%)]	Loss: 0.509780
Train epoch 3: [18000/18806 (95.7%)]	Loss: 0.499760
====> Epoch 3: Average train loss 0.488727
====> Dev set loss: 0.197013
New best dev set loss: 0.197013
Saved checkpoint for model
Train epoch 4: [1000/18806 (5.3%)]	Loss: 0.671970
Train epoch 4: [2000/18806 (10.6%)]	Loss: 0.597305
Train epoch 4: [3000/18806 (16.0%)]	Loss: 0.531308
Train epoch 4: [4000/18806 (21.3%)]	Loss: 0.486231
Train epoch 4: [5000/18806 (26.6%)]	Loss: 0.441869
Train epoch 4: [6000/18806 (31.9%)]	Loss: 0.406102
Train epoch 4: [7000/18806 (37.2%)]	Loss: 0.375504
Train epoch 4: [8000/18806 (42.5%)]	Loss: 0.354261
Train epoch 4: [9000/18806 (47.9%)]	Loss: 0.344823
Train epoch 4: [10000/18806 (53.2%)]	Loss: 0.347848
Train epoch 4: [11000/18806 (58.5%)]	Loss: 0.383484
Train epoch 4: [12000/18806 (63.8%)]	Loss: 0.409488
Train epoch 4: [13000/18806 (69.1%)]	Loss: 0.434900
Train epoch 4: [14000/18806 (74.4%)]	Loss: 0.456298
Train epoch 4: [15000/18806 (79.8%)]	Loss: 0.475202
Train epoch 4: [16000/18806 (85.1%)]	Loss: 0.492416
Train epoch 4: [17000/18806 (90.4%)]	Loss: 0.484532
Train epoch 4: [18000/18806 (95.7%)]	Loss: 0.473849
====> Epoch 4: Average train loss 0.463082
====> Dev set loss: 0.193824
New best dev set loss: 0.193824
Saved checkpoint for model
Train epoch 5: [1000/18806 (5.3%)]	Loss: 0.634824
Train epoch 5: [2000/18806 (10.6%)]	Loss: 0.563100
Train epoch 5: [3000/18806 (16.0%)]	Loss: 0.501467
Train epoch 5: [4000/18806 (21.3%)]	Loss: 0.458859
Train epoch 5: [5000/18806 (26.6%)]	Loss: 0.416010
Train epoch 5: [6000/18806 (31.9%)]	Loss: 0.382944
Train epoch 5: [7000/18806 (37.2%)]	Loss: 0.353587
Train epoch 5: [8000/18806 (42.5%)]	Loss: 0.333395
Train epoch 5: [9000/18806 (47.9%)]	Loss: 0.324652
Train epoch 5: [10000/18806 (53.2%)]	Loss: 0.327679
Train epoch 5: [11000/18806 (58.5%)]	Loss: 0.360527
Train epoch 5: [12000/18806 (63.8%)]	Loss: 0.383382
Train epoch 5: [13000/18806 (69.1%)]	Loss: 0.406947
Train epoch 5: [14000/18806 (74.4%)]	Loss: 0.426866
Train epoch 5: [15000/18806 (79.8%)]	Loss: 0.443714
Train epoch 5: [16000/18806 (85.1%)]	Loss: 0.460940
Train epoch 5: [17000/18806 (90.4%)]	Loss: 0.453489
Train epoch 5: [18000/18806 (95.7%)]	Loss: 0.444286
====> Epoch 5: Average train loss 0.434531
====> Dev set loss: 0.195862
No improvement in 1 epochs (best dev set loss: 0.193824)
Not saving checkpoint; no improvement made
Train epoch 6: [1000/18806 (5.3%)]	Loss: 0.597827
Train epoch 6: [2000/18806 (10.6%)]	Loss: 0.530339
Train epoch 6: [3000/18806 (16.0%)]	Loss: 0.475613
Train epoch 6: [4000/18806 (21.3%)]	Loss: 0.432712
Train epoch 6: [5000/18806 (26.6%)]	Loss: 0.392336
Train epoch 6: [6000/18806 (31.9%)]	Loss: 0.360183
Train epoch 6: [7000/18806 (37.2%)]	Loss: 0.332598
Train epoch 6: [8000/18806 (42.5%)]	Loss: 0.313755
Train epoch 6: [9000/18806 (47.9%)]	Loss: 0.305183
Train epoch 6: [10000/18806 (53.2%)]	Loss: 0.307679
Train epoch 6: [11000/18806 (58.5%)]	Loss: 0.336268
Train epoch 6: [12000/18806 (63.8%)]	Loss: 0.358959
Train epoch 6: [13000/18806 (69.1%)]	Loss: 0.380606
Train epoch 6: [14000/18806 (74.4%)]	Loss: 0.399216
Train epoch 6: [15000/18806 (79.8%)]	Loss: 0.416370
Train epoch 6: [16000/18806 (85.1%)]	Loss: 0.431400
Train epoch 6: [17000/18806 (90.4%)]	Loss: 0.424787
Train epoch 6: [18000/18806 (95.7%)]	Loss: 0.416004
====> Epoch 6: Average train loss 0.407071
====> Dev set loss: 0.197061
No improvement in 2 epochs (best dev set loss: 0.193824)
Not saving checkpoint; no improvement made
Train epoch 7: [1000/18806 (5.3%)]	Loss: 0.561852
Train epoch 7: [2000/18806 (10.6%)]	Loss: 0.494714
Train epoch 7: [3000/18806 (16.0%)]	Loss: 0.445179
Train epoch 7: [4000/18806 (21.3%)]	Loss: 0.404747
Train epoch 7: [5000/18806 (26.6%)]	Loss: 0.367395
Train epoch 7: [6000/18806 (31.9%)]	Loss: 0.337842
Train epoch 7: [7000/18806 (37.2%)]	Loss: 0.312589
Train epoch 7: [8000/18806 (42.5%)]	Loss: 0.295227
Train epoch 7: [9000/18806 (47.9%)]	Loss: 0.288150
Train epoch 7: [10000/18806 (53.2%)]	Loss: 0.290499
Train epoch 7: [11000/18806 (58.5%)]	Loss: 0.316956
Train epoch 7: [12000/18806 (63.8%)]	Loss: 0.335787
Train epoch 7: [13000/18806 (69.1%)]	Loss: 0.355815
Train epoch 7: [14000/18806 (74.4%)]	Loss: 0.372136
Train epoch 7: [15000/18806 (79.8%)]	Loss: 0.387034
Train epoch 7: [16000/18806 (85.1%)]	Loss: 0.402854
Train epoch 7: [17000/18806 (90.4%)]	Loss: 0.396680
Train epoch 7: [18000/18806 (95.7%)]	Loss: 0.388887
====> Epoch 7: Average train loss 0.380841
====> Dev set loss: 0.192665
New best dev set loss: 0.192665
Saved checkpoint for model
Train epoch 8: [1000/18806 (5.3%)]	Loss: 0.518845
Train epoch 8: [2000/18806 (10.6%)]	Loss: 0.458368
Train epoch 8: [3000/18806 (16.0%)]	Loss: 0.414196
Train epoch 8: [4000/18806 (21.3%)]	Loss: 0.378629
Train epoch 8: [5000/18806 (26.6%)]	Loss: 0.344433
Train epoch 8: [6000/18806 (31.9%)]	Loss: 0.317007
Train epoch 8: [7000/18806 (37.2%)]	Loss: 0.293739
Train epoch 8: [8000/18806 (42.5%)]	Loss: 0.278341
Train epoch 8: [9000/18806 (47.9%)]	Loss: 0.271951
Train epoch 8: [10000/18806 (53.2%)]	Loss: 0.275046
Train epoch 8: [11000/18806 (58.5%)]	Loss: 0.298815
Train epoch 8: [12000/18806 (63.8%)]	Loss: 0.315388
Train epoch 8: [13000/18806 (69.1%)]	Loss: 0.333005
Train epoch 8: [14000/18806 (74.4%)]	Loss: 0.348004
Train epoch 8: [15000/18806 (79.8%)]	Loss: 0.361809
Train epoch 8: [16000/18806 (85.1%)]	Loss: 0.376428
Train epoch 8: [17000/18806 (90.4%)]	Loss: 0.370951
Train epoch 8: [18000/18806 (95.7%)]	Loss: 0.363839
====> Epoch 8: Average train loss 0.356606
====> Dev set loss: 0.187541
New best dev set loss: 0.187541
Saved checkpoint for model
Train epoch 9: [1000/18806 (5.3%)]	Loss: 0.481015
Train epoch 9: [2000/18806 (10.6%)]	Loss: 0.425275
Train epoch 9: [3000/18806 (16.0%)]	Loss: 0.384125
Train epoch 9: [4000/18806 (21.3%)]	Loss: 0.350096
Train epoch 9: [5000/18806 (26.6%)]	Loss: 0.318562
Train epoch 9: [6000/18806 (31.9%)]	Loss: 0.293668
Train epoch 9: [7000/18806 (37.2%)]	Loss: 0.272811
Train epoch 9: [8000/18806 (42.5%)]	Loss: 0.258704
Train epoch 9: [9000/18806 (47.9%)]	Loss: 0.252938
Train epoch 9: [10000/18806 (53.2%)]	Loss: 0.255516
Train epoch 9: [11000/18806 (58.5%)]	Loss: 0.276942
Train epoch 9: [12000/18806 (63.8%)]	Loss: 0.291873
Train epoch 9: [13000/18806 (69.1%)]	Loss: 0.308396
Train epoch 9: [14000/18806 (74.4%)]	Loss: 0.323019
Train epoch 9: [15000/18806 (79.8%)]	Loss: 0.336786
Train epoch 9: [16000/18806 (85.1%)]	Loss: 0.349837
Train epoch 9: [17000/18806 (90.4%)]	Loss: 0.344720
Train epoch 9: [18000/18806 (95.7%)]	Loss: 0.338041
====> Epoch 9: Average train loss 0.331600
====> Dev set loss: 0.180130
New best dev set loss: 0.180130
Saved checkpoint for model
Train epoch 10: [1000/18806 (5.3%)]	Loss: 0.449826
Train epoch 10: [2000/18806 (10.6%)]	Loss: 0.394524
Train epoch 10: [3000/18806 (16.0%)]	Loss: 0.357080
Train epoch 10: [4000/18806 (21.3%)]	Loss: 0.325952
Train epoch 10: [5000/18806 (26.6%)]	Loss: 0.297917
Train epoch 10: [6000/18806 (31.9%)]	Loss: 0.275811
Train epoch 10: [7000/18806 (37.2%)]	Loss: 0.257068
Train epoch 10: [8000/18806 (42.5%)]	Loss: 0.244548
Train epoch 10: [9000/18806 (47.9%)]	Loss: 0.239494
Train epoch 10: [10000/18806 (53.2%)]	Loss: 0.243051
Train epoch 10: [11000/18806 (58.5%)]	Loss: 0.263401
Train epoch 10: [12000/18806 (63.8%)]	Loss: 0.278262
Train epoch 10: [13000/18806 (69.1%)]	Loss: 0.293148
Train epoch 10: [14000/18806 (74.4%)]	Loss: 0.306528
Train epoch 10: [15000/18806 (79.8%)]	Loss: 0.319676
Train epoch 10: [16000/18806 (85.1%)]	Loss: 0.331835
Train epoch 10: [17000/18806 (90.4%)]	Loss: 0.326726
Train epoch 10: [18000/18806 (95.7%)]	Loss: 0.320287
====> Epoch 10: Average train loss 0.314326
====> Dev set loss: 0.190329
No improvement in 1 epochs (best dev set loss: 0.180130)
Not saving checkpoint; no improvement made
Train epoch 11: [1000/18806 (5.3%)]	Loss: 0.413633
Train epoch 11: [2000/18806 (10.6%)]	Loss: 0.365979
Train epoch 11: [3000/18806 (16.0%)]	Loss: 0.331632
Train epoch 11: [4000/18806 (21.3%)]	Loss: 0.304063
Train epoch 11: [5000/18806 (26.6%)]	Loss: 0.277336
Train epoch 11: [6000/18806 (31.9%)]	Loss: 0.256853
Train epoch 11: [7000/18806 (37.2%)]	Loss: 0.239736
Train epoch 11: [8000/18806 (42.5%)]	Loss: 0.228814
Train epoch 11: [9000/18806 (47.9%)]	Loss: 0.224508
Train epoch 11: [10000/18806 (53.2%)]	Loss: 0.226386
Train epoch 11: [11000/18806 (58.5%)]	Loss: 0.244162
Train epoch 11: [12000/18806 (63.8%)]	Loss: 0.256988
Train epoch 11: [13000/18806 (69.1%)]	Loss: 0.271109
Train epoch 11: [14000/18806 (74.4%)]	Loss: 0.283420
Train epoch 11: [15000/18806 (79.8%)]	Loss: 0.294934
Train epoch 11: [16000/18806 (85.1%)]	Loss: 0.307657
Train epoch 11: [17000/18806 (90.4%)]	Loss: 0.303671
Train epoch 11: [18000/18806 (95.7%)]	Loss: 0.298250
====> Epoch 11: Average train loss 0.293143
====> Dev set loss: 0.186776
No improvement in 2 epochs (best dev set loss: 0.180130)
Not saving checkpoint; no improvement made
Train epoch 12: [1000/18806 (5.3%)]	Loss: 0.386122
Train epoch 12: [2000/18806 (10.6%)]	Loss: 0.341142
Train epoch 12: [3000/18806 (16.0%)]	Loss: 0.312462
Train epoch 12: [4000/18806 (21.3%)]	Loss: 0.286778
Train epoch 12: [5000/18806 (26.6%)]	Loss: 0.262121
Train epoch 12: [6000/18806 (31.9%)]	Loss: 0.243526
Train epoch 12: [7000/18806 (37.2%)]	Loss: 0.227873
Train epoch 12: [8000/18806 (42.5%)]	Loss: 0.217400
Train epoch 12: [9000/18806 (47.9%)]	Loss: 0.213668
Train epoch 12: [10000/18806 (53.2%)]	Loss: 0.215506
Train epoch 12: [11000/18806 (58.5%)]	Loss: 0.232157
Train epoch 12: [12000/18806 (63.8%)]	Loss: 0.243647
Train epoch 12: [13000/18806 (69.1%)]	Loss: 0.256612
Train epoch 12: [14000/18806 (74.4%)]	Loss: 0.268418
Train epoch 12: [15000/18806 (79.8%)]	Loss: 0.279277
Train epoch 12: [16000/18806 (85.1%)]	Loss: 0.290683
Train epoch 12: [17000/18806 (90.4%)]	Loss: 0.286654
Train epoch 12: [18000/18806 (95.7%)]	Loss: 0.281617
====> Epoch 12: Average train loss 0.277024
====> Dev set loss: 0.183816
No improvement in 3 epochs (best dev set loss: 0.180130)
STOPPING EARLY
Computing reconstruction loss...
Loaded checkpoint; best model ready now.
====> Training set reconstruction loss: 0.155475
====> Dev set reconstruction loss: 0.151415
Trained convolutional variational multidecoder.
