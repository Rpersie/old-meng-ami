Setting up environment...
Environment set up.
Training convolutional multidecoder...
Constructing model...
Done constructing model.
CNNMultidecoder (
  (encoder_conv): Sequential (
    (conv2d_0): Conv2d(1, 256, kernel_size=(3, 3), stride=(1, 1))
    (batchnorm2d_0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (maxpool2d_0): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
    (conv2d_1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1))
    (batchnorm2d_1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (maxpool2d_1): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
    (conv2d_2): Conv2d(256, 128, kernel_size=(3, 3), stride=(1, 1))
    (batchnorm2d_2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True)
    (SELU_2): SELU
  )
  (encoder_fc): Sequential (
    (lin_0): Linear (3840 -> 1024)
    (batchnorm1d_0): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (lin_1): Linear (1024 -> 1024)
    (batchnorm1d_1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (lin_final): Linear (1024 -> 1024)
    (SELU_final): SELU
  )
  (decoder_fc_ihm): Sequential (
    (lin_0): Linear (1024 -> 1024)
    (batchnorm1d_0): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (lin_1): Linear (1024 -> 1024)
    (batchnorm1d_1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (lin_final): Linear (1024 -> 3840)
    (SELU_final): SELU
  )
  (decoder_deconv_ihm): Sequential (
    (conv2d_0): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (maxunpool2d_2): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_2): Conv2d(256, 1, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_2): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True)
    (SELU_2): SELU
  )
  (decoder_fc_sdm1): Sequential (
    (lin_0): Linear (1024 -> 1024)
    (batchnorm1d_0): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (lin_1): Linear (1024 -> 1024)
    (batchnorm1d_1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (lin_final): Linear (1024 -> 3840)
    (SELU_final): SELU
  )
  (decoder_deconv_sdm1): Sequential (
    (conv2d_0): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (maxunpool2d_2): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_2): Conv2d(256, 1, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (batchnorm2d_2): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True)
    (SELU_2): SELU
  )
)
Setting up data...
Setting up training datasets...
Using 2407138 training features (9403 batches) for class ihm
Using 2407138 training features (9403 batches) for class sdm1
Setting up dev datasets...
Using 249565 dev features (975 batches) for class ihm
Using 249565 dev features (975 batches) for class sdm1
Setting up minibatch shuffling for training...
18806 total batches: {'ihm': 9403, 'sdm1': 9403}
Done setting up data.
Starting training!
Train epoch 1: [1000/18806 (5.3%)]	Loss: 0.554533
Train epoch 1: [2000/18806 (10.6%)]	Loss: 0.462785
Train epoch 1: [3000/18806 (16.0%)]	Loss: 0.400003
Train epoch 1: [4000/18806 (21.3%)]	Loss: 0.357950
Train epoch 1: [5000/18806 (26.6%)]	Loss: 0.319718
Train epoch 1: [6000/18806 (31.9%)]	Loss: 0.289032
Train epoch 1: [7000/18806 (37.2%)]	Loss: 0.262678
Train epoch 1: [8000/18806 (42.5%)]	Loss: 0.244407
Train epoch 1: [9000/18806 (47.9%)]	Loss: 0.237624
Train epoch 1: [10000/18806 (53.2%)]	Loss: 0.246857
Train epoch 1: [11000/18806 (58.5%)]	Loss: 0.292770
Train epoch 1: [12000/18806 (63.8%)]	Loss: 0.325901
Train epoch 1: [13000/18806 (69.1%)]	Loss: 0.359060
Train epoch 1: [14000/18806 (74.4%)]	Loss: 0.385542
Train epoch 1: [15000/18806 (79.8%)]	Loss: 0.408649
Train epoch 1: [16000/18806 (85.1%)]	Loss: 0.430223
Train epoch 1: [17000/18806 (90.4%)]	Loss: 0.419539
Train epoch 1: [18000/18806 (95.7%)]	Loss: 0.407366
====> Epoch 1: Average train loss 0.394921
====> Dev set loss: 0.066049
New best dev set loss: 0.066049
Saved checkpoint for model
Train epoch 2: [1000/18806 (5.3%)]	Loss: 0.546468
Train epoch 2: [2000/18806 (10.6%)]	Loss: 0.478873
Train epoch 2: [3000/18806 (16.0%)]	Loss: 0.415253
Train epoch 2: [4000/18806 (21.3%)]	Loss: 0.371505
Train epoch 2: [5000/18806 (26.6%)]	Loss: 0.328967
Train epoch 2: [6000/18806 (31.9%)]	Loss: 0.295904
Train epoch 2: [7000/18806 (37.2%)]	Loss: 0.266407
Train epoch 2: [8000/18806 (42.5%)]	Loss: 0.245800
Train epoch 2: [9000/18806 (47.9%)]	Loss: 0.237448
Train epoch 2: [10000/18806 (53.2%)]	Loss: 0.240569
Train epoch 2: [11000/18806 (58.5%)]	Loss: 0.275573
Train epoch 2: [12000/18806 (63.8%)]	Loss: 0.299920
Train epoch 2: [13000/18806 (69.1%)]	Loss: 0.326145
Train epoch 2: [14000/18806 (74.4%)]	Loss: 0.349108
Train epoch 2: [15000/18806 (79.8%)]	Loss: 0.366408
Train epoch 2: [16000/18806 (85.1%)]	Loss: 0.384271
Train epoch 2: [17000/18806 (90.4%)]	Loss: 0.375640
Train epoch 2: [18000/18806 (95.7%)]	Loss: 0.365203
====> Epoch 2: Average train loss 0.354038
====> Dev set loss: 0.066893
No improvement in 1 epochs (best dev set loss: 0.066049)
Not saving checkpoint; no improvement made
Train epoch 3: [1000/18806 (5.3%)]	Loss: 0.534295
Train epoch 3: [2000/18806 (10.6%)]	Loss: 0.464840
Train epoch 3: [3000/18806 (16.0%)]	Loss: 0.401825
Train epoch 3: [4000/18806 (21.3%)]	Loss: 0.358182
Train epoch 3: [5000/18806 (26.6%)]	Loss: 0.316809
Train epoch 3: [6000/18806 (31.9%)]	Loss: 0.283901
Train epoch 3: [7000/18806 (37.2%)]	Loss: 0.254928
Train epoch 3: [8000/18806 (42.5%)]	Loss: 0.234266
Train epoch 3: [9000/18806 (47.9%)]	Loss: 0.225797
Train epoch 3: [10000/18806 (53.2%)]	Loss: 0.227131
Train epoch 3: [11000/18806 (58.5%)]	Loss: 0.254655
Train epoch 3: [12000/18806 (63.8%)]	Loss: 0.274203
Train epoch 3: [13000/18806 (69.1%)]	Loss: 0.296604
Train epoch 3: [14000/18806 (74.4%)]	Loss: 0.315928
Train epoch 3: [15000/18806 (79.8%)]	Loss: 0.332147
Train epoch 3: [16000/18806 (85.1%)]	Loss: 0.347051
Train epoch 3: [17000/18806 (90.4%)]	Loss: 0.339368
Train epoch 3: [18000/18806 (95.7%)]	Loss: 0.329969
====> Epoch 3: Average train loss 0.319811
====> Dev set loss: 0.061452
New best dev set loss: 0.061452
Saved checkpoint for model
Train epoch 4: [1000/18806 (5.3%)]	Loss: 0.492261
Train epoch 4: [2000/18806 (10.6%)]	Loss: 0.429060
Train epoch 4: [3000/18806 (16.0%)]	Loss: 0.367572
Train epoch 4: [4000/18806 (21.3%)]	Loss: 0.328947
Train epoch 4: [5000/18806 (26.6%)]	Loss: 0.290467
Train epoch 4: [6000/18806 (31.9%)]	Loss: 0.259659
Train epoch 4: [7000/18806 (37.2%)]	Loss: 0.232691
Train epoch 4: [8000/18806 (42.5%)]	Loss: 0.214095
Train epoch 4: [9000/18806 (47.9%)]	Loss: 0.206099
Train epoch 4: [10000/18806 (53.2%)]	Loss: 0.206215
Train epoch 4: [11000/18806 (58.5%)]	Loss: 0.229726
Train epoch 4: [12000/18806 (63.8%)]	Loss: 0.245736
Train epoch 4: [13000/18806 (69.1%)]	Loss: 0.265105
Train epoch 4: [14000/18806 (74.4%)]	Loss: 0.281802
Train epoch 4: [15000/18806 (79.8%)]	Loss: 0.296759
Train epoch 4: [16000/18806 (85.1%)]	Loss: 0.310222
Train epoch 4: [17000/18806 (90.4%)]	Loss: 0.303641
Train epoch 4: [18000/18806 (95.7%)]	Loss: 0.294590
====> Epoch 4: Average train loss 0.285523
====> Dev set loss: 0.062336
No improvement in 1 epochs (best dev set loss: 0.061452)
Not saving checkpoint; no improvement made
Train epoch 5: [1000/18806 (5.3%)]	Loss: 0.446092
Train epoch 5: [2000/18806 (10.6%)]	Loss: 0.387134
Train epoch 5: [3000/18806 (16.0%)]	Loss: 0.331314
Train epoch 5: [4000/18806 (21.3%)]	Loss: 0.295468
Train epoch 5: [5000/18806 (26.6%)]	Loss: 0.259665
Train epoch 5: [6000/18806 (31.9%)]	Loss: 0.232418
Train epoch 5: [7000/18806 (37.2%)]	Loss: 0.208024
Train epoch 5: [8000/18806 (42.5%)]	Loss: 0.191174
Train epoch 5: [9000/18806 (47.9%)]	Loss: 0.183742
Train epoch 5: [10000/18806 (53.2%)]	Loss: 0.183941
Train epoch 5: [11000/18806 (58.5%)]	Loss: 0.204168
Train epoch 5: [12000/18806 (63.8%)]	Loss: 0.217194
Train epoch 5: [13000/18806 (69.1%)]	Loss: 0.234387
Train epoch 5: [14000/18806 (74.4%)]	Loss: 0.249320
Train epoch 5: [15000/18806 (79.8%)]	Loss: 0.262096
Train epoch 5: [16000/18806 (85.1%)]	Loss: 0.275195
Train epoch 5: [17000/18806 (90.4%)]	Loss: 0.269244
Train epoch 5: [18000/18806 (95.7%)]	Loss: 0.261531
====> Epoch 5: Average train loss 0.253497
====> Dev set loss: 0.057426
New best dev set loss: 0.057426
Saved checkpoint for model
Train epoch 6: [1000/18806 (5.3%)]	Loss: 0.397750
Train epoch 6: [2000/18806 (10.6%)]	Loss: 0.343097
Train epoch 6: [3000/18806 (16.0%)]	Loss: 0.296675
Train epoch 6: [4000/18806 (21.3%)]	Loss: 0.262483
Train epoch 6: [5000/18806 (26.6%)]	Loss: 0.230812
Train epoch 6: [6000/18806 (31.9%)]	Loss: 0.205671
Train epoch 6: [7000/18806 (37.2%)]	Loss: 0.184133
Train epoch 6: [8000/18806 (42.5%)]	Loss: 0.169192
Train epoch 6: [9000/18806 (47.9%)]	Loss: 0.162524
Train epoch 6: [10000/18806 (53.2%)]	Loss: 0.162711
Train epoch 6: [11000/18806 (58.5%)]	Loss: 0.179121
Train epoch 6: [12000/18806 (63.8%)]	Loss: 0.191520
Train epoch 6: [13000/18806 (69.1%)]	Loss: 0.206891
Train epoch 6: [14000/18806 (74.4%)]	Loss: 0.220561
Train epoch 6: [15000/18806 (79.8%)]	Loss: 0.233169
Train epoch 6: [16000/18806 (85.1%)]	Loss: 0.244289
Train epoch 6: [17000/18806 (90.4%)]	Loss: 0.239153
Train epoch 6: [18000/18806 (95.7%)]	Loss: 0.232190
====> Epoch 6: Average train loss 0.225111
====> Dev set loss: 0.052190
New best dev set loss: 0.052190
Saved checkpoint for model
Train epoch 7: [1000/18806 (5.3%)]	Loss: 0.358126
Train epoch 7: [2000/18806 (10.6%)]	Loss: 0.305430
Train epoch 7: [3000/18806 (16.0%)]	Loss: 0.265017
Train epoch 7: [4000/18806 (21.3%)]	Loss: 0.234616
Train epoch 7: [5000/18806 (26.6%)]	Loss: 0.206144
Train epoch 7: [6000/18806 (31.9%)]	Loss: 0.183839
Train epoch 7: [7000/18806 (37.2%)]	Loss: 0.164358
Train epoch 7: [8000/18806 (42.5%)]	Loss: 0.151052
Train epoch 7: [9000/18806 (47.9%)]	Loss: 0.145384
Train epoch 7: [10000/18806 (53.2%)]	Loss: 0.145306
Train epoch 7: [11000/18806 (58.5%)]	Loss: 0.159843
Train epoch 7: [12000/18806 (63.8%)]	Loss: 0.169538
Train epoch 7: [13000/18806 (69.1%)]	Loss: 0.183664
Train epoch 7: [14000/18806 (74.4%)]	Loss: 0.195497
Train epoch 7: [15000/18806 (79.8%)]	Loss: 0.206319
Train epoch 7: [16000/18806 (85.1%)]	Loss: 0.217981
Train epoch 7: [17000/18806 (90.4%)]	Loss: 0.213472
Train epoch 7: [18000/18806 (95.7%)]	Loss: 0.207517
====> Epoch 7: Average train loss 0.201235
====> Dev set loss: 0.052273
No improvement in 1 epochs (best dev set loss: 0.052190)
Not saving checkpoint; no improvement made
Train epoch 8: [1000/18806 (5.3%)]	Loss: 0.322563
Train epoch 8: [2000/18806 (10.6%)]	Loss: 0.278765
Train epoch 8: [3000/18806 (16.0%)]	Loss: 0.240235
Train epoch 8: [4000/18806 (21.3%)]	Loss: 0.211802
Train epoch 8: [5000/18806 (26.6%)]	Loss: 0.185755
Train epoch 8: [6000/18806 (31.9%)]	Loss: 0.165345
Train epoch 8: [7000/18806 (37.2%)]	Loss: 0.147855
Train epoch 8: [8000/18806 (42.5%)]	Loss: 0.135791
Train epoch 8: [9000/18806 (47.9%)]	Loss: 0.131164
Train epoch 8: [10000/18806 (53.2%)]	Loss: 0.131295
Train epoch 8: [11000/18806 (58.5%)]	Loss: 0.144038
Train epoch 8: [12000/18806 (63.8%)]	Loss: 0.152417
Train epoch 8: [13000/18806 (69.1%)]	Loss: 0.164691
Train epoch 8: [14000/18806 (74.4%)]	Loss: 0.175412
Train epoch 8: [15000/18806 (79.8%)]	Loss: 0.185244
Train epoch 8: [16000/18806 (85.1%)]	Loss: 0.195736
Train epoch 8: [17000/18806 (90.4%)]	Loss: 0.191550
Train epoch 8: [18000/18806 (95.7%)]	Loss: 0.186209
====> Epoch 8: Average train loss 0.180673
====> Dev set loss: 0.041401
New best dev set loss: 0.041401
Saved checkpoint for model
Train epoch 9: [1000/18806 (5.3%)]	Loss: 0.300991
Train epoch 9: [2000/18806 (10.6%)]	Loss: 0.253106
Train epoch 9: [3000/18806 (16.0%)]	Loss: 0.218705
Train epoch 9: [4000/18806 (21.3%)]	Loss: 0.192652
Train epoch 9: [5000/18806 (26.6%)]	Loss: 0.169051
Train epoch 9: [6000/18806 (31.9%)]	Loss: 0.150557
Train epoch 9: [7000/18806 (37.2%)]	Loss: 0.134717
Train epoch 9: [8000/18806 (42.5%)]	Loss: 0.124012
Train epoch 9: [9000/18806 (47.9%)]	Loss: 0.119791
Train epoch 9: [10000/18806 (53.2%)]	Loss: 0.119864
Train epoch 9: [11000/18806 (58.5%)]	Loss: 0.130713
Train epoch 9: [12000/18806 (63.8%)]	Loss: 0.137763
Train epoch 9: [13000/18806 (69.1%)]	Loss: 0.149021
Train epoch 9: [14000/18806 (74.4%)]	Loss: 0.159213
Train epoch 9: [15000/18806 (79.8%)]	Loss: 0.168672
Train epoch 9: [16000/18806 (85.1%)]	Loss: 0.177751
Train epoch 9: [17000/18806 (90.4%)]	Loss: 0.173782
Train epoch 9: [18000/18806 (95.7%)]	Loss: 0.168731
====> Epoch 9: Average train loss 0.163732
====> Dev set loss: 0.047453
No improvement in 1 epochs (best dev set loss: 0.041401)
Not saving checkpoint; no improvement made
Train epoch 10: [1000/18806 (5.3%)]	Loss: 0.263924
Train epoch 10: [2000/18806 (10.6%)]	Loss: 0.222602
Train epoch 10: [3000/18806 (16.0%)]	Loss: 0.192763
Train epoch 10: [4000/18806 (21.3%)]	Loss: 0.169859
Train epoch 10: [5000/18806 (26.6%)]	Loss: 0.149215
Train epoch 10: [6000/18806 (31.9%)]	Loss: 0.133192
Train epoch 10: [7000/18806 (37.2%)]	Loss: 0.119495
Train epoch 10: [8000/18806 (42.5%)]	Loss: 0.110206
Train epoch 10: [9000/18806 (47.9%)]	Loss: 0.106223
Train epoch 10: [10000/18806 (53.2%)]	Loss: 0.106740
Train epoch 10: [11000/18806 (58.5%)]	Loss: 0.116827
Train epoch 10: [12000/18806 (63.8%)]	Loss: 0.124009
Train epoch 10: [13000/18806 (69.1%)]	Loss: 0.134166
Train epoch 10: [14000/18806 (74.4%)]	Loss: 0.143588
Train epoch 10: [15000/18806 (79.8%)]	Loss: 0.152637
Train epoch 10: [16000/18806 (85.1%)]	Loss: 0.161071
Train epoch 10: [17000/18806 (90.4%)]	Loss: 0.157481
Train epoch 10: [18000/18806 (95.7%)]	Loss: 0.152912
====> Epoch 10: Average train loss 0.148448
====> Dev set loss: 0.048002
No improvement in 2 epochs (best dev set loss: 0.041401)
Not saving checkpoint; no improvement made
Train epoch 11: [1000/18806 (5.3%)]	Loss: 0.239124
Train epoch 11: [2000/18806 (10.6%)]	Loss: 0.202549
Train epoch 11: [3000/18806 (16.0%)]	Loss: 0.175713
Train epoch 11: [4000/18806 (21.3%)]	Loss: 0.155745
Train epoch 11: [5000/18806 (26.6%)]	Loss: 0.136480
Train epoch 11: [6000/18806 (31.9%)]	Loss: 0.121672
Train epoch 11: [7000/18806 (37.2%)]	Loss: 0.109046
Train epoch 11: [8000/18806 (42.5%)]	Loss: 0.100525
Train epoch 11: [9000/18806 (47.9%)]	Loss: 0.097526
Train epoch 11: [10000/18806 (53.2%)]	Loss: 0.097611
Train epoch 11: [11000/18806 (58.5%)]	Loss: 0.106485
Train epoch 11: [12000/18806 (63.8%)]	Loss: 0.112448
Train epoch 11: [13000/18806 (69.1%)]	Loss: 0.121917
Train epoch 11: [14000/18806 (74.4%)]	Loss: 0.130430
Train epoch 11: [15000/18806 (79.8%)]	Loss: 0.138274
Train epoch 11: [16000/18806 (85.1%)]	Loss: 0.146817
Train epoch 11: [17000/18806 (90.4%)]	Loss: 0.143699
Train epoch 11: [18000/18806 (95.7%)]	Loss: 0.139600
====> Epoch 11: Average train loss 0.135579
====> Dev set loss: 0.045764
No improvement in 3 epochs (best dev set loss: 0.041401)
STOPPING EARLY
Trained convolutional multidecoder.
