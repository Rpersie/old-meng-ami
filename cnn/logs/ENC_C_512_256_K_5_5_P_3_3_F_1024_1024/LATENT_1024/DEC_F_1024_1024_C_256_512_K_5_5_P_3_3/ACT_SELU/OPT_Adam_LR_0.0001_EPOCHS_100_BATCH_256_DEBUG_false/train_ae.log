Setting up environment...
Environment set up.
Training convolutional multidecoder...
Constructing model...
Done constructing model.
CNNMultidecoder (
  (encoder_conv): Sequential (
    (conv2d_0): Conv2d(1, 512, kernel_size=(5, 5), stride=(1, 1))
    (batchnorm2d_0): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (maxpool2d_0): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
    (conv2d_1): Conv2d(512, 256, kernel_size=(5, 5), stride=(1, 1))
    (batchnorm2d_1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (maxpool2d_1): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
  )
  (encoder_fc): Sequential (
    (lin_0): Linear (5376 -> 1024)
    (batchnorm1d_0): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (lin_1): Linear (1024 -> 1024)
    (batchnorm1d_1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (lin_final): Linear (1024 -> 1024)
    (SELU_final): SELU
  )
  (decoder_fc_ihm): Sequential (
    (lin_0): Linear (1024 -> 1024)
    (batchnorm1d_0): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (lin_1): Linear (1024 -> 1024)
    (batchnorm1d_1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (lin_final): Linear (1024 -> 5376)
    (SELU_final): SELU
  )
  (decoder_deconv_ihm): Sequential (
    (maxunpool2d_0): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_0): Conv2d(256, 512, kernel_size=(5, 5), stride=(1, 1), padding=(4, 4))
    (batchnorm2d_0): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(512, 1, kernel_size=(5, 5), stride=(1, 1), padding=(4, 4))
    (batchnorm2d_1): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
  )
  (decoder_fc_sdm1): Sequential (
    (lin_0): Linear (1024 -> 1024)
    (batchnorm1d_0): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (lin_1): Linear (1024 -> 1024)
    (batchnorm1d_1): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
    (lin_final): Linear (1024 -> 5376)
    (SELU_final): SELU
  )
  (decoder_deconv_sdm1): Sequential (
    (maxunpool2d_0): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_0): Conv2d(256, 512, kernel_size=(5, 5), stride=(1, 1), padding=(4, 4))
    (batchnorm2d_0): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True)
    (SELU_0): SELU
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(512, 1, kernel_size=(5, 5), stride=(1, 1), padding=(4, 4))
    (batchnorm2d_1): BatchNorm2d(1, eps=1e-05, momentum=0.1, affine=True)
    (SELU_1): SELU
  )
)
Setting up data...
Setting up training datasets...
Using 2407138 training features (9403 batches) for class ihm
Using 2407138 training features (9403 batches) for class sdm1
Setting up dev datasets...
Using 249565 dev features (975 batches) for class ihm
Using 249565 dev features (975 batches) for class sdm1
Setting up minibatch shuffling for training...
18806 total batches: {'ihm': 9403, 'sdm1': 9403}
Done setting up data.
Starting training!
Train epoch 1: [1000/18806 (5.3%)]	Loss: 0.505635
Train epoch 1: [2000/18806 (10.6%)]	Loss: 0.428304
Train epoch 1: [3000/18806 (16.0%)]	Loss: 0.380599
Train epoch 1: [4000/18806 (21.3%)]	Loss: 0.342728
Train epoch 1: [5000/18806 (26.6%)]	Loss: 0.306147
Train epoch 1: [6000/18806 (31.9%)]	Loss: 0.277097
Train epoch 1: [7000/18806 (37.2%)]	Loss: 0.252296
Train epoch 1: [8000/18806 (42.5%)]	Loss: 0.235386
Train epoch 1: [9000/18806 (47.9%)]	Loss: 0.229919
Train epoch 1: [10000/18806 (53.2%)]	Loss: 0.240282
Train epoch 1: [11000/18806 (58.5%)]	Loss: 0.287061
Train epoch 1: [12000/18806 (63.8%)]	Loss: 0.320954
Train epoch 1: [13000/18806 (69.1%)]	Loss: 0.354536
Train epoch 1: [14000/18806 (74.4%)]	Loss: 0.381415
Train epoch 1: [15000/18806 (79.8%)]	Loss: 0.404979
Train epoch 1: [16000/18806 (85.1%)]	Loss: 0.426992
Train epoch 1: [17000/18806 (90.4%)]	Loss: 0.416774
Train epoch 1: [18000/18806 (95.7%)]	Loss: 0.404928
====> Epoch 1: Average train loss 0.392793
====> Dev set loss: 0.084703
New best dev set loss: 0.084703
Saved checkpoint for model
Train epoch 2: [1000/18806 (5.3%)]	Loss: 0.544630
Train epoch 2: [2000/18806 (10.6%)]	Loss: 0.476739
Train epoch 2: [3000/18806 (16.0%)]	Loss: 0.413558
Train epoch 2: [4000/18806 (21.3%)]	Loss: 0.370243
Train epoch 2: [5000/18806 (26.6%)]	Loss: 0.327738
Train epoch 2: [6000/18806 (31.9%)]	Loss: 0.294700
Train epoch 2: [7000/18806 (37.2%)]	Loss: 0.265207
Train epoch 2: [8000/18806 (42.5%)]	Loss: 0.245157
Train epoch 2: [9000/18806 (47.9%)]	Loss: 0.237437
Train epoch 2: [10000/18806 (53.2%)]	Loss: 0.241015
Train epoch 2: [11000/18806 (58.5%)]	Loss: 0.276362
Train epoch 2: [12000/18806 (63.8%)]	Loss: 0.301107
Train epoch 2: [13000/18806 (69.1%)]	Loss: 0.327513
Train epoch 2: [14000/18806 (74.4%)]	Loss: 0.350631
Train epoch 2: [15000/18806 (79.8%)]	Loss: 0.368233
Train epoch 2: [16000/18806 (85.1%)]	Loss: 0.386255
Train epoch 2: [17000/18806 (90.4%)]	Loss: 0.377635
Train epoch 2: [18000/18806 (95.7%)]	Loss: 0.367305
====> Epoch 2: Average train loss 0.356354
====> Dev set loss: 0.072961
New best dev set loss: 0.072961
Saved checkpoint for model
Train epoch 3: [1000/18806 (5.3%)]	Loss: 0.532419
Train epoch 3: [2000/18806 (10.6%)]	Loss: 0.463556
Train epoch 3: [3000/18806 (16.0%)]	Loss: 0.401095
Train epoch 3: [4000/18806 (21.3%)]	Loss: 0.357761
Train epoch 3: [5000/18806 (26.6%)]	Loss: 0.316370
Train epoch 3: [6000/18806 (31.9%)]	Loss: 0.283623
Train epoch 3: [7000/18806 (37.2%)]	Loss: 0.254862
Train epoch 3: [8000/18806 (42.5%)]	Loss: 0.234862
Train epoch 3: [9000/18806 (47.9%)]	Loss: 0.227055
Train epoch 3: [10000/18806 (53.2%)]	Loss: 0.228882
Train epoch 3: [11000/18806 (58.5%)]	Loss: 0.256880
Train epoch 3: [12000/18806 (63.8%)]	Loss: 0.276975
Train epoch 3: [13000/18806 (69.1%)]	Loss: 0.299608
Train epoch 3: [14000/18806 (74.4%)]	Loss: 0.319151
Train epoch 3: [15000/18806 (79.8%)]	Loss: 0.335740
Train epoch 3: [16000/18806 (85.1%)]	Loss: 0.350889
Train epoch 3: [17000/18806 (90.4%)]	Loss: 0.343201
Train epoch 3: [18000/18806 (95.7%)]	Loss: 0.333879
====> Epoch 3: Average train loss 0.323854
====> Dev set loss: 0.067161
New best dev set loss: 0.067161
Saved checkpoint for model
Train epoch 4: [1000/18806 (5.3%)]	Loss: 0.491782
Train epoch 4: [2000/18806 (10.6%)]	Loss: 0.428686
Train epoch 4: [3000/18806 (16.0%)]	Loss: 0.367137
Train epoch 4: [4000/18806 (21.3%)]	Loss: 0.328495
Train epoch 4: [5000/18806 (26.6%)]	Loss: 0.290031
Train epoch 4: [6000/18806 (31.9%)]	Loss: 0.259323
Train epoch 4: [7000/18806 (37.2%)]	Loss: 0.232500
Train epoch 4: [8000/18806 (42.5%)]	Loss: 0.214471
Train epoch 4: [9000/18806 (47.9%)]	Loss: 0.207238
Train epoch 4: [10000/18806 (53.2%)]	Loss: 0.208015
Train epoch 4: [11000/18806 (58.5%)]	Loss: 0.232282
Train epoch 4: [12000/18806 (63.8%)]	Loss: 0.248981
Train epoch 4: [13000/18806 (69.1%)]	Loss: 0.268722
Train epoch 4: [14000/18806 (74.4%)]	Loss: 0.285770
Train epoch 4: [15000/18806 (79.8%)]	Loss: 0.301241
Train epoch 4: [16000/18806 (85.1%)]	Loss: 0.315234
Train epoch 4: [17000/18806 (90.4%)]	Loss: 0.308702
Train epoch 4: [18000/18806 (95.7%)]	Loss: 0.299672
====> Epoch 4: Average train loss 0.290616
====> Dev set loss: 0.066134
New best dev set loss: 0.066134
Saved checkpoint for model
Train epoch 5: [1000/18806 (5.3%)]	Loss: 0.445920
Train epoch 5: [2000/18806 (10.6%)]	Loss: 0.386258
Train epoch 5: [3000/18806 (16.0%)]	Loss: 0.331230
Train epoch 5: [4000/18806 (21.3%)]	Loss: 0.295522
Train epoch 5: [5000/18806 (26.6%)]	Loss: 0.259712
Train epoch 5: [6000/18806 (31.9%)]	Loss: 0.232697
Train epoch 5: [7000/18806 (37.2%)]	Loss: 0.208552
Train epoch 5: [8000/18806 (42.5%)]	Loss: 0.192346
Train epoch 5: [9000/18806 (47.9%)]	Loss: 0.185600
Train epoch 5: [10000/18806 (53.2%)]	Loss: 0.186420
Train epoch 5: [11000/18806 (58.5%)]	Loss: 0.207465
Train epoch 5: [12000/18806 (63.8%)]	Loss: 0.221204
Train epoch 5: [13000/18806 (69.1%)]	Loss: 0.238786
Train epoch 5: [14000/18806 (74.4%)]	Loss: 0.254129
Train epoch 5: [15000/18806 (79.8%)]	Loss: 0.267412
Train epoch 5: [16000/18806 (85.1%)]	Loss: 0.280981
Train epoch 5: [17000/18806 (90.4%)]	Loss: 0.275101
Train epoch 5: [18000/18806 (95.7%)]	Loss: 0.267429
====> Epoch 5: Average train loss 0.259520
====> Dev set loss: 0.067700
No improvement in 1 epochs (best dev set loss: 0.066134)
Not saving checkpoint; no improvement made
Train epoch 6: [1000/18806 (5.3%)]	Loss: 0.398290
Train epoch 6: [2000/18806 (10.6%)]	Loss: 0.343638
Train epoch 6: [3000/18806 (16.0%)]	Loss: 0.297101
Train epoch 6: [4000/18806 (21.3%)]	Loss: 0.263050
Train epoch 6: [5000/18806 (26.6%)]	Loss: 0.231615
Train epoch 6: [6000/18806 (31.9%)]	Loss: 0.206735
Train epoch 6: [7000/18806 (37.2%)]	Loss: 0.185318
Train epoch 6: [8000/18806 (42.5%)]	Loss: 0.170988
Train epoch 6: [9000/18806 (47.9%)]	Loss: 0.164967
Train epoch 6: [10000/18806 (53.2%)]	Loss: 0.165796
Train epoch 6: [11000/18806 (58.5%)]	Loss: 0.182869
Train epoch 6: [12000/18806 (63.8%)]	Loss: 0.195938
Train epoch 6: [13000/18806 (69.1%)]	Loss: 0.211744
Train epoch 6: [14000/18806 (74.4%)]	Loss: 0.225845
Train epoch 6: [15000/18806 (79.8%)]	Loss: 0.239015
Train epoch 6: [16000/18806 (85.1%)]	Loss: 0.250604
Train epoch 6: [17000/18806 (90.4%)]	Loss: 0.245587
Train epoch 6: [18000/18806 (95.7%)]	Loss: 0.238617
====> Epoch 6: Average train loss 0.231614
====> Dev set loss: 0.061232
New best dev set loss: 0.061232
Saved checkpoint for model
Train epoch 7: [1000/18806 (5.3%)]	Loss: 0.360099
Train epoch 7: [2000/18806 (10.6%)]	Loss: 0.307745
Train epoch 7: [3000/18806 (16.0%)]	Loss: 0.266380
Train epoch 7: [4000/18806 (21.3%)]	Loss: 0.235180
Train epoch 7: [5000/18806 (26.6%)]	Loss: 0.206859
Train epoch 7: [6000/18806 (31.9%)]	Loss: 0.184842
Train epoch 7: [7000/18806 (37.2%)]	Loss: 0.165525
Train epoch 7: [8000/18806 (42.5%)]	Loss: 0.152831
Train epoch 7: [9000/18806 (47.9%)]	Loss: 0.147923
Train epoch 7: [10000/18806 (53.2%)]	Loss: 0.148585
Train epoch 7: [11000/18806 (58.5%)]	Loss: 0.163848
Train epoch 7: [12000/18806 (63.8%)]	Loss: 0.174190
Train epoch 7: [13000/18806 (69.1%)]	Loss: 0.188759
Train epoch 7: [14000/18806 (74.4%)]	Loss: 0.201076
Train epoch 7: [15000/18806 (79.8%)]	Loss: 0.212449
Train epoch 7: [16000/18806 (85.1%)]	Loss: 0.224466
Train epoch 7: [17000/18806 (90.4%)]	Loss: 0.219964
Train epoch 7: [18000/18806 (95.7%)]	Loss: 0.213903
====> Epoch 7: Average train loss 0.207774
====> Dev set loss: 0.062920
No improvement in 1 epochs (best dev set loss: 0.061232)
Not saving checkpoint; no improvement made
Train epoch 8: [1000/18806 (5.3%)]	Loss: 0.322272
Train epoch 8: [2000/18806 (10.6%)]	Loss: 0.276383
Train epoch 8: [3000/18806 (16.0%)]	Loss: 0.238939
Train epoch 8: [4000/18806 (21.3%)]	Loss: 0.211522
Train epoch 8: [5000/18806 (26.6%)]	Loss: 0.185900
Train epoch 8: [6000/18806 (31.9%)]	Loss: 0.165847
Train epoch 8: [7000/18806 (37.2%)]	Loss: 0.148577
Train epoch 8: [8000/18806 (42.5%)]	Loss: 0.137220
Train epoch 8: [9000/18806 (47.9%)]	Loss: 0.133337
Train epoch 8: [10000/18806 (53.2%)]	Loss: 0.134591
Train epoch 8: [11000/18806 (58.5%)]	Loss: 0.148193
Train epoch 8: [12000/18806 (63.8%)]	Loss: 0.157250
Train epoch 8: [13000/18806 (69.1%)]	Loss: 0.169996
Train epoch 8: [14000/18806 (74.4%)]	Loss: 0.181243
Train epoch 8: [15000/18806 (79.8%)]	Loss: 0.191637
Train epoch 8: [16000/18806 (85.1%)]	Loss: 0.202661
Train epoch 8: [17000/18806 (90.4%)]	Loss: 0.198513
Train epoch 8: [18000/18806 (95.7%)]	Loss: 0.193071
====> Epoch 8: Average train loss 0.187653
====> Dev set loss: 0.058480
New best dev set loss: 0.058480
Saved checkpoint for model
Train epoch 9: [1000/18806 (5.3%)]	Loss: 0.290542
Train epoch 9: [2000/18806 (10.6%)]	Loss: 0.246668
Train epoch 9: [3000/18806 (16.0%)]	Loss: 0.213766
Train epoch 9: [4000/18806 (21.3%)]	Loss: 0.188881
Train epoch 9: [5000/18806 (26.6%)]	Loss: 0.166153
Train epoch 9: [6000/18806 (31.9%)]	Loss: 0.148270
Train epoch 9: [7000/18806 (37.2%)]	Loss: 0.132976
Train epoch 9: [8000/18806 (42.5%)]	Loss: 0.123117
Train epoch 9: [9000/18806 (47.9%)]	Loss: 0.119731
Train epoch 9: [10000/18806 (53.2%)]	Loss: 0.120694
Train epoch 9: [11000/18806 (58.5%)]	Loss: 0.132447
Train epoch 9: [12000/18806 (63.8%)]	Loss: 0.140340
Train epoch 9: [13000/18806 (69.1%)]	Loss: 0.152204
Train epoch 9: [14000/18806 (74.4%)]	Loss: 0.163050
Train epoch 9: [15000/18806 (79.8%)]	Loss: 0.173212
Train epoch 9: [16000/18806 (85.1%)]	Loss: 0.182865
Train epoch 9: [17000/18806 (90.4%)]	Loss: 0.179026
Train epoch 9: [18000/18806 (95.7%)]	Loss: 0.174050
====> Epoch 9: Average train loss 0.169198
====> Dev set loss: 0.056110
New best dev set loss: 0.056110
Saved checkpoint for model
Train epoch 10: [1000/18806 (5.3%)]	Loss: 0.263581
Train epoch 10: [2000/18806 (10.6%)]	Loss: 0.222292
Train epoch 10: [3000/18806 (16.0%)]	Loss: 0.192836
Train epoch 10: [4000/18806 (21.3%)]	Loss: 0.170780
Train epoch 10: [5000/18806 (26.6%)]	Loss: 0.150365
Train epoch 10: [6000/18806 (31.9%)]	Loss: 0.134289
Train epoch 10: [7000/18806 (37.2%)]	Loss: 0.120696
Train epoch 10: [8000/18806 (42.5%)]	Loss: 0.111934
Train epoch 10: [9000/18806 (47.9%)]	Loss: 0.108578
Train epoch 10: [10000/18806 (53.2%)]	Loss: 0.109715
Train epoch 10: [11000/18806 (58.5%)]	Loss: 0.120565
Train epoch 10: [12000/18806 (63.8%)]	Loss: 0.128436
Train epoch 10: [13000/18806 (69.1%)]	Loss: 0.139206
Train epoch 10: [14000/18806 (74.4%)]	Loss: 0.149243
Train epoch 10: [15000/18806 (79.8%)]	Loss: 0.158931
Train epoch 10: [16000/18806 (85.1%)]	Loss: 0.168064
Train epoch 10: [17000/18806 (90.4%)]	Loss: 0.164410
Train epoch 10: [18000/18806 (95.7%)]	Loss: 0.159730
====> Epoch 10: Average train loss 0.155352
====> Dev set loss: 0.062213
No improvement in 1 epochs (best dev set loss: 0.056110)
Not saving checkpoint; no improvement made
Train epoch 11: [1000/18806 (5.3%)]	Loss: 0.237587
Train epoch 11: [2000/18806 (10.6%)]	Loss: 0.201313
Train epoch 11: [3000/18806 (16.0%)]	Loss: 0.174294
Train epoch 11: [4000/18806 (21.3%)]	Loss: 0.154825
Train epoch 11: [5000/18806 (26.6%)]	Loss: 0.136117
Train epoch 11: [6000/18806 (31.9%)]	Loss: 0.121725
Train epoch 11: [7000/18806 (37.2%)]	Loss: 0.109366
Train epoch 11: [8000/18806 (42.5%)]	Loss: 0.101455
Train epoch 11: [9000/18806 (47.9%)]	Loss: 0.099117
Train epoch 11: [10000/18806 (53.2%)]	Loss: 0.099992
Train epoch 11: [11000/18806 (58.5%)]	Loss: 0.109707
Train epoch 11: [12000/18806 (63.8%)]	Loss: 0.116441
Train epoch 11: [13000/18806 (69.1%)]	Loss: 0.126494
Train epoch 11: [14000/18806 (74.4%)]	Loss: 0.135646
Train epoch 11: [15000/18806 (79.8%)]	Loss: 0.144154
Train epoch 11: [16000/18806 (85.1%)]	Loss: 0.153380
Train epoch 11: [17000/18806 (90.4%)]	Loss: 0.150262
Train epoch 11: [18000/18806 (95.7%)]	Loss: 0.146114
====> Epoch 11: Average train loss 0.142214
====> Dev set loss: 0.063077
No improvement in 2 epochs (best dev set loss: 0.056110)
Not saving checkpoint; no improvement made
Train epoch 12: [1000/18806 (5.3%)]	Loss: 0.217421
Train epoch 12: [2000/18806 (10.6%)]	Loss: 0.183123
Train epoch 12: [3000/18806 (16.0%)]	Loss: 0.160024
Train epoch 12: [4000/18806 (21.3%)]	Loss: 0.141598
Train epoch 12: [5000/18806 (26.6%)]	Loss: 0.124347
Train epoch 12: [6000/18806 (31.9%)]	Loss: 0.111392
Train epoch 12: [7000/18806 (37.2%)]	Loss: 0.100296
Train epoch 12: [8000/18806 (42.5%)]	Loss: 0.093352
Train epoch 12: [9000/18806 (47.9%)]	Loss: 0.091309
Train epoch 12: [10000/18806 (53.2%)]	Loss: 0.092454
Train epoch 12: [11000/18806 (58.5%)]	Loss: 0.101687
Train epoch 12: [12000/18806 (63.8%)]	Loss: 0.107644
Train epoch 12: [13000/18806 (69.1%)]	Loss: 0.116876
Train epoch 12: [14000/18806 (74.4%)]	Loss: 0.125629
Train epoch 12: [15000/18806 (79.8%)]	Loss: 0.133581
Train epoch 12: [16000/18806 (85.1%)]	Loss: 0.141888
Train epoch 12: [17000/18806 (90.4%)]	Loss: 0.138874
Train epoch 12: [18000/18806 (95.7%)]	Loss: 0.135163
====> Epoch 12: Average train loss 0.131659
====> Dev set loss: 0.059474
No improvement in 3 epochs (best dev set loss: 0.056110)
STOPPING EARLY
Trained convolutional multidecoder.
