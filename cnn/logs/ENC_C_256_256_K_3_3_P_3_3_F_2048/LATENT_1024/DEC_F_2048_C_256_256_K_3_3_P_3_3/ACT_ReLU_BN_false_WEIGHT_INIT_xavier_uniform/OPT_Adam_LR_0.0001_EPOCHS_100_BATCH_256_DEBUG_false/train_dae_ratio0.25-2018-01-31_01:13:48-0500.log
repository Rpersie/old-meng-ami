Running training with mode dae
Noising 25.000% of input features
Constructing model...
Done constructing model.
CNNMultidecoder (
  (encoder_conv): Sequential (
    (conv2d_0): Conv2d(1, 256, kernel_size=(3, 3), stride=(1, 1))
    (ReLU_0): ReLU ()
    (maxpool2d_0): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
    (conv2d_1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1))
    (ReLU_1): ReLU ()
    (maxpool2d_1): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
  )
  (encoder_fc): Sequential (
    (lin_0): Linear (14336 -> 2048)
    (ReLU_0): ReLU ()
    (lin_final): Linear (2048 -> 1024)
    (ReLU_final): ReLU ()
  )
  (decoder_fc_ihm): Sequential (
    (lin_0): Linear (1024 -> 2048)
    (ReLU_0): ReLU ()
    (lin_final): Linear (2048 -> 14336)
    (ReLU_final): ReLU ()
  )
  (decoder_deconv_ihm): Sequential (
    (maxunpool2d_0): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ReLU_0): ReLU ()
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(256, 1, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ReLU_1): ReLU ()
  )
  (decoder_fc_sdm1): Sequential (
    (lin_0): Linear (1024 -> 2048)
    (ReLU_0): ReLU ()
    (lin_final): Linear (2048 -> 14336)
    (ReLU_final): ReLU ()
  )
  (decoder_deconv_sdm1): Sequential (
    (maxunpool2d_0): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ReLU_0): ReLU ()
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(256, 1, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ReLU_1): ReLU ()
  )
)
Setting up data...
Setting up training datasets...
Using 2407138 training features (9403 batches) for class ihm
Using 2407138 training features (9403 batches) for class sdm1
Setting up dev datasets...
Using 249565 dev features (975 batches) for class ihm
Using 249565 dev features (975 batches) for class sdm1
Setting up minibatch shuffling for training...
18806 total batches: {'ihm': 9403, 'sdm1': 9403}
Done setting up data.
Completed setup in 191.417 seconds
Starting training!
Train epoch 1: [1000/18806 (5.3%)]	Loss: 0.679585
Train epoch 1: [2000/18806 (10.6%)]	Loss: 0.613007
Train epoch 1: [3000/18806 (16.0%)]	Loss: 0.582411
Train epoch 1: [4000/18806 (21.3%)]	Loss: 0.564516
Train epoch 1: [5000/18806 (26.6%)]	Loss: 0.553498
Train epoch 1: [6000/18806 (31.9%)]	Loss: 0.549642
Train epoch 1: [7000/18806 (37.2%)]	Loss: 0.541987
Train epoch 1: [8000/18806 (42.5%)]	Loss: 0.534421
Train epoch 1: [9000/18806 (47.9%)]	Loss: 0.530325
Train epoch 1: [10000/18806 (53.2%)]	Loss: 0.528415
Train epoch 1: [11000/18806 (58.5%)]	Loss: 0.524754
Train epoch 1: [12000/18806 (63.8%)]	Loss: 0.522711
Train epoch 1: [13000/18806 (69.1%)]	Loss: 0.521052
Train epoch 1: [14000/18806 (74.4%)]	Loss: 0.519957
Train epoch 1: [15000/18806 (79.8%)]	Loss: 0.518164
Train epoch 1: [16000/18806 (85.1%)]	Loss: 0.516769
Train epoch 1: [17000/18806 (90.4%)]	Loss: 0.514432
Train epoch 1: [18000/18806 (95.7%)]	Loss: 0.514520
====> Epoch 1 (2359.817s): Average train loss 0.513140 (['ihm: 0.552442', 'sdm1: 0.473837'])
====> Dev set loss (105.542s): 0.438430 (['ihm: 0.460183', 'sdm1: 0.416678'])
New best dev set loss: 0.438430
Saved checkpoint for model
Train epoch 2: [1000/18806 (5.3%)]	Loss: 0.479024
Train epoch 2: [2000/18806 (10.6%)]	Loss: 0.482637
Train epoch 2: [3000/18806 (16.0%)]	Loss: 0.484229
Train epoch 2: [4000/18806 (21.3%)]	Loss: 0.483489
Train epoch 2: [5000/18806 (26.6%)]	Loss: 0.482532
Train epoch 2: [6000/18806 (31.9%)]	Loss: 0.490189
Train epoch 2: [7000/18806 (37.2%)]	Loss: 0.489265
Train epoch 2: [8000/18806 (42.5%)]	Loss: 0.485925
Train epoch 2: [9000/18806 (47.9%)]	Loss: 0.486068
Train epoch 2: [10000/18806 (53.2%)]	Loss: 0.486540
Train epoch 2: [11000/18806 (58.5%)]	Loss: 0.485637
Train epoch 2: [12000/18806 (63.8%)]	Loss: 0.484894
Train epoch 2: [13000/18806 (69.1%)]	Loss: 0.485596
Train epoch 2: [14000/18806 (74.4%)]	Loss: 0.485897
Train epoch 2: [15000/18806 (79.8%)]	Loss: 0.486281
Train epoch 2: [16000/18806 (85.1%)]	Loss: 0.486419
Train epoch 2: [17000/18806 (90.4%)]	Loss: 0.485395
Train epoch 2: [18000/18806 (95.7%)]	Loss: 0.486879
====> Epoch 2 (2340.992s): Average train loss 0.486306 (['ihm: 0.526673', 'sdm1: 0.445939'])
====> Dev set loss (106.933s): 0.428265 (['ihm: 0.450647', 'sdm1: 0.405882'])
New best dev set loss: 0.428265
Saved checkpoint for model
Train epoch 3: [1000/18806 (5.3%)]	Loss: 0.471333
Train epoch 3: [2000/18806 (10.6%)]	Loss: 0.477663
Train epoch 3: [3000/18806 (16.0%)]	Loss: 0.478203
Train epoch 3: [4000/18806 (21.3%)]	Loss: 0.478461
Train epoch 3: [5000/18806 (26.6%)]	Loss: 0.476839
Train epoch 3: [6000/18806 (31.9%)]	Loss: 0.483897
Train epoch 3: [7000/18806 (37.2%)]	Loss: 0.482843
Train epoch 3: [8000/18806 (42.5%)]	Loss: 0.480567
Train epoch 3: [9000/18806 (47.9%)]	Loss: 0.480401
Train epoch 3: [10000/18806 (53.2%)]	Loss: 0.481295
Train epoch 3: [11000/18806 (58.5%)]	Loss: 0.480151
Train epoch 3: [12000/18806 (63.8%)]	Loss: 0.479426
Train epoch 3: [13000/18806 (69.1%)]	Loss: 0.479955
Train epoch 3: [14000/18806 (74.4%)]	Loss: 0.480617
Train epoch 3: [15000/18806 (79.8%)]	Loss: 0.481155
Train epoch 3: [16000/18806 (85.1%)]	Loss: 0.481488
Train epoch 3: [17000/18806 (90.4%)]	Loss: 0.480734
Train epoch 3: [18000/18806 (95.7%)]	Loss: 0.482205
====> Epoch 3 (2401.107s): Average train loss 0.481713 (['ihm: 0.522468', 'sdm1: 0.440957'])
====> Dev set loss (105.427s): 0.426658 (['ihm: 0.449669', 'sdm1: 0.403646'])
New best dev set loss: 0.426658
Saved checkpoint for model
Train epoch 4: [1000/18806 (5.3%)]	Loss: 0.471472
Train epoch 4: [2000/18806 (10.6%)]	Loss: 0.471738
Train epoch 4: [3000/18806 (16.0%)]	Loss: 0.474882
Train epoch 4: [4000/18806 (21.3%)]	Loss: 0.473895
Train epoch 4: [5000/18806 (26.6%)]	Loss: 0.475238
Train epoch 4: [6000/18806 (31.9%)]	Loss: 0.481603
Train epoch 4: [7000/18806 (37.2%)]	Loss: 0.479998
Train epoch 4: [8000/18806 (42.5%)]	Loss: 0.477611
Train epoch 4: [9000/18806 (47.9%)]	Loss: 0.477906
Train epoch 4: [10000/18806 (53.2%)]	Loss: 0.478720
Train epoch 4: [11000/18806 (58.5%)]	Loss: 0.477946
Train epoch 4: [12000/18806 (63.8%)]	Loss: 0.477253
Train epoch 4: [13000/18806 (69.1%)]	Loss: 0.478208
Train epoch 4: [14000/18806 (74.4%)]	Loss: 0.478491
Train epoch 4: [15000/18806 (79.8%)]	Loss: 0.478699
Train epoch 4: [16000/18806 (85.1%)]	Loss: 0.479114
Train epoch 4: [17000/18806 (90.4%)]	Loss: 0.478328
Train epoch 4: [18000/18806 (95.7%)]	Loss: 0.479718
====> Epoch 4 (2335.828s): Average train loss 0.479377 (['ihm: 0.520424', 'sdm1: 0.438330'])
====> Dev set loss (102.366s): 0.427451 (['ihm: 0.448573', 'sdm1: 0.406329'])
No improvement in 1 epochs (best dev set loss: 0.426658)
Not saving checkpoint; no improvement made
Train epoch 5: [1000/18806 (5.3%)]	Loss: 0.470148
Train epoch 5: [2000/18806 (10.6%)]	Loss: 0.471212
Train epoch 5: [3000/18806 (16.0%)]	Loss: 0.474231
Train epoch 5: [4000/18806 (21.3%)]	Loss: 0.472081
Train epoch 5: [5000/18806 (26.6%)]	Loss: 0.471495
Train epoch 5: [6000/18806 (31.9%)]	Loss: 0.480016
Train epoch 5: [7000/18806 (37.2%)]	Loss: 0.478777
Train epoch 5: [8000/18806 (42.5%)]	Loss: 0.475183
Train epoch 5: [9000/18806 (47.9%)]	Loss: 0.475758
Train epoch 5: [10000/18806 (53.2%)]	Loss: 0.477254
Train epoch 5: [11000/18806 (58.5%)]	Loss: 0.476458
Train epoch 5: [12000/18806 (63.8%)]	Loss: 0.475825
Train epoch 5: [13000/18806 (69.1%)]	Loss: 0.476839
Train epoch 5: [14000/18806 (74.4%)]	Loss: 0.476993
Train epoch 5: [15000/18806 (79.8%)]	Loss: 0.477682
Train epoch 5: [16000/18806 (85.1%)]	Loss: 0.477696
Train epoch 5: [17000/18806 (90.4%)]	Loss: 0.476737
Train epoch 5: [18000/18806 (95.7%)]	Loss: 0.478434
====> Epoch 5 (2334.903s): Average train loss 0.477965 (['ihm: 0.519181', 'sdm1: 0.436749'])
====> Dev set loss (104.292s): 0.423344 (['ihm: 0.447798', 'sdm1: 0.398891'])
New best dev set loss: 0.423344
Saved checkpoint for model
Train epoch 6: [1000/18806 (5.3%)]	Loss: 0.467219
Train epoch 6: [2000/18806 (10.6%)]	Loss: 0.474511
Train epoch 6: [3000/18806 (16.0%)]	Loss: 0.473132
Train epoch 6: [4000/18806 (21.3%)]	Loss: 0.473834
Train epoch 6: [5000/18806 (26.6%)]	Loss: 0.473185
Train epoch 6: [6000/18806 (31.9%)]	Loss: 0.479336
Train epoch 6: [7000/18806 (37.2%)]	Loss: 0.477826
Train epoch 6: [8000/18806 (42.5%)]	Loss: 0.475163
Train epoch 6: [9000/18806 (47.9%)]	Loss: 0.474952
Train epoch 6: [10000/18806 (53.2%)]	Loss: 0.476139
Train epoch 6: [11000/18806 (58.5%)]	Loss: 0.475398
Train epoch 6: [12000/18806 (63.8%)]	Loss: 0.474328
Train epoch 6: [13000/18806 (69.1%)]	Loss: 0.475269
Train epoch 6: [14000/18806 (74.4%)]	Loss: 0.475965
Train epoch 6: [15000/18806 (79.8%)]	Loss: 0.476295
Train epoch 6: [16000/18806 (85.1%)]	Loss: 0.476914
Train epoch 6: [17000/18806 (90.4%)]	Loss: 0.475914
Train epoch 6: [18000/18806 (95.7%)]	Loss: 0.477600
====> Epoch 6 (2330.188s): Average train loss 0.477185 (['ihm: 0.518773', 'sdm1: 0.435596'])
====> Dev set loss (102.951s): 0.421659 (['ihm: 0.444406', 'sdm1: 0.398912'])
New best dev set loss: 0.421659
Saved checkpoint for model
Train epoch 7: [1000/18806 (5.3%)]	Loss: 0.463746
Train epoch 7: [2000/18806 (10.6%)]	Loss: 0.471186
Train epoch 7: [3000/18806 (16.0%)]	Loss: 0.472382
Train epoch 7: [4000/18806 (21.3%)]	Loss: 0.469322
Train epoch 7: [5000/18806 (26.6%)]	Loss: 0.469822
Train epoch 7: [6000/18806 (31.9%)]	Loss: 0.477361
Train epoch 7: [7000/18806 (37.2%)]	Loss: 0.476414
Train epoch 7: [8000/18806 (42.5%)]	Loss: 0.472834
Train epoch 7: [9000/18806 (47.9%)]	Loss: 0.473327
Train epoch 7: [10000/18806 (53.2%)]	Loss: 0.474768
Train epoch 7: [11000/18806 (58.5%)]	Loss: 0.473955
Train epoch 7: [12000/18806 (63.8%)]	Loss: 0.473361
Train epoch 7: [13000/18806 (69.1%)]	Loss: 0.474610
Train epoch 7: [14000/18806 (74.4%)]	Loss: 0.475642
Train epoch 7: [15000/18806 (79.8%)]	Loss: 0.475637
Train epoch 7: [16000/18806 (85.1%)]	Loss: 0.475779
Train epoch 7: [17000/18806 (90.4%)]	Loss: 0.474797
Train epoch 7: [18000/18806 (95.7%)]	Loss: 0.476353
====> Epoch 7 (2329.440s): Average train loss 0.475930 (['ihm: 0.517651', 'sdm1: 0.434209'])
====> Dev set loss (105.513s): 0.423212 (['ihm: 0.445873', 'sdm1: 0.400551'])
No improvement in 1 epochs (best dev set loss: 0.421659)
Not saving checkpoint; no improvement made
Train epoch 8: [1000/18806 (5.3%)]	Loss: 0.460195
Train epoch 8: [2000/18806 (10.6%)]	Loss: 0.468301
Train epoch 8: [3000/18806 (16.0%)]	Loss: 0.471612
Train epoch 8: [4000/18806 (21.3%)]	Loss: 0.470513
Train epoch 8: [5000/18806 (26.6%)]	Loss: 0.472817
Train epoch 8: [6000/18806 (31.9%)]	Loss: 0.476679
Train epoch 8: [7000/18806 (37.2%)]	Loss: 0.475122
Train epoch 8: [8000/18806 (42.5%)]	Loss: 0.472999
Train epoch 8: [9000/18806 (47.9%)]	Loss: 0.473526
Train epoch 8: [10000/18806 (53.2%)]	Loss: 0.474016
Train epoch 8: [11000/18806 (58.5%)]	Loss: 0.472963
Train epoch 8: [12000/18806 (63.8%)]	Loss: 0.473004
Train epoch 8: [13000/18806 (69.1%)]	Loss: 0.473629
Train epoch 8: [14000/18806 (74.4%)]	Loss: 0.473865
