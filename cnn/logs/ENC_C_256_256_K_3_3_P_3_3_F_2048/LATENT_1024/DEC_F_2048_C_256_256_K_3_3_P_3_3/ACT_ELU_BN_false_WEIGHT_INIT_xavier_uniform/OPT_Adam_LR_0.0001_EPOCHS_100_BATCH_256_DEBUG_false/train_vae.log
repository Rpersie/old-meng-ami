Setting up environment...
Environment set up.
Training convolutional variational multidecoder...
Constructing model...
Done constructing model.
CNNVariationalMultidecoder (
  (encoder_conv): Sequential (
    (conv2d_0): Conv2d(1, 256, kernel_size=(3, 3), stride=(1, 1))
    (ELU_0): ELU (alpha=1.0)
    (maxpool2d_0): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
    (conv2d_1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1))
    (ELU_1): ELU (alpha=1.0)
    (maxpool2d_1): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
  )
  (encoder_fc): Sequential (
    (lin_0): Linear (14336 -> 2048)
    (ELU_0): ELU (alpha=1.0)
  )
  (decoder_fc_ihm): Sequential (
    (lin_0): Linear (1024 -> 2048)
    (ELU_0): ELU (alpha=1.0)
    (lin_final): Linear (2048 -> 14336)
    (ELU_final): ELU (alpha=1.0)
  )
  (decoder_deconv_ihm): Sequential (
    (maxunpool2d_0): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ELU_0): ELU (alpha=1.0)
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(256, 1, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ELU_1): ELU (alpha=1.0)
  )
  (decoder_fc_sdm1): Sequential (
    (lin_0): Linear (1024 -> 2048)
    (ELU_0): ELU (alpha=1.0)
    (lin_final): Linear (2048 -> 14336)
    (ELU_final): ELU (alpha=1.0)
  )
  (decoder_deconv_sdm1): Sequential (
    (maxunpool2d_0): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ELU_0): ELU (alpha=1.0)
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(256, 1, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ELU_1): ELU (alpha=1.0)
  )
  (latent_mu): Sequential (
    (lin): Linear (2048 -> 1024)
    (ELU): ELU (alpha=1.0)
  )
  (latent_logvar): Sequential (
    (lin): Linear (2048 -> 1024)
    (ELU): ELU (alpha=1.0)
  )
)
Setting up data...
Setting up training datasets...
Using 2407138 training features (9403 batches) for class ihm
Using 2407138 training features (9403 batches) for class sdm1
Setting up dev datasets...
Using 249565 dev features (975 batches) for class ihm
Using 249565 dev features (975 batches) for class sdm1
Setting up minibatch shuffling for training...
Done setting up data.
Starting training!
Train epoch 1: [1000/18806 (5.3%)]	Loss: 0.610229
Train epoch 1: [2000/18806 (10.6%)]	Loss: 0.551027
Train epoch 1: [3000/18806 (16.0%)]	Loss: 0.527831
Train epoch 1: [4000/18806 (21.3%)]	Loss: 0.511189
Train epoch 1: [5000/18806 (26.6%)]	Loss: 0.502358
Train epoch 1: [6000/18806 (31.9%)]	Loss: 0.494282
Train epoch 1: [7000/18806 (37.2%)]	Loss: 0.485811
Train epoch 1: [8000/18806 (42.5%)]	Loss: 0.481066
Train epoch 1: [9000/18806 (47.9%)]	Loss: 0.475054
Train epoch 1: [10000/18806 (53.2%)]	Loss: 0.472989
Train epoch 1: [11000/18806 (58.5%)]	Loss: 0.467833
Train epoch 1: [12000/18806 (63.8%)]	Loss: 0.463209
Train epoch 1: [13000/18806 (69.1%)]	Loss: 0.458567
Train epoch 1: [14000/18806 (74.4%)]	Loss: 0.455102
Train epoch 1: [15000/18806 (79.8%)]	Loss: 0.453828
Train epoch 1: [16000/18806 (85.1%)]	Loss: 0.450330
Train epoch 1: [17000/18806 (90.4%)]	Loss: 0.446060
Train epoch 1: [18000/18806 (95.7%)]	Loss: 0.441963
====> Epoch 1: Average train loss 0.441977 (['ihm: 0.479392', 'sdm1: 0.404561'])
====> Dev set loss: 0.439878 (['ihm: 0.465099', 'sdm1: 0.414657'])
New best dev set loss: 0.439878
Saved checkpoint for model
Train epoch 2: [1000/18806 (5.3%)]	Loss: 0.368510
Train epoch 2: [2000/18806 (10.6%)]	Loss: 0.369313
Train epoch 2: [3000/18806 (16.0%)]	Loss: 0.370531
Train epoch 2: [4000/18806 (21.3%)]	Loss: 0.367359
Train epoch 2: [5000/18806 (26.6%)]	Loss: 0.374182
Train epoch 2: [6000/18806 (31.9%)]	Loss: 0.371511
Train epoch 2: [7000/18806 (37.2%)]	Loss: 0.368252
Train epoch 2: [8000/18806 (42.5%)]	Loss: 0.365963
Train epoch 2: [9000/18806 (47.9%)]	Loss: 0.364942
Train epoch 2: [10000/18806 (53.2%)]	Loss: 0.363457
Train epoch 2: [11000/18806 (58.5%)]	Loss: 0.361510
Train epoch 2: [12000/18806 (63.8%)]	Loss: 0.363518
Train epoch 2: [13000/18806 (69.1%)]	Loss: 0.361446
Train epoch 2: [14000/18806 (74.4%)]	Loss: 0.359841
Train epoch 2: [15000/18806 (79.8%)]	Loss: 0.359311
Train epoch 2: [16000/18806 (85.1%)]	Loss: 0.358583
Train epoch 2: [17000/18806 (90.4%)]	Loss: 0.356873
Train epoch 2: [18000/18806 (95.7%)]	Loss: 0.356097
====> Epoch 2: Average train loss 0.354943 (['ihm: 0.389795', 'sdm1: 0.320090'])
====> Dev set loss: 0.337216 (['ihm: 0.343341', 'sdm1: 0.331091'])
New best dev set loss: 0.337216
Saved checkpoint for model
Train epoch 3: [1000/18806 (5.3%)]	Loss: 0.331521
Train epoch 3: [2000/18806 (10.6%)]	Loss: 0.333833
Train epoch 3: [3000/18806 (16.0%)]	Loss: 0.338420
Train epoch 3: [4000/18806 (21.3%)]	Loss: 0.336499
Train epoch 3: [5000/18806 (26.6%)]	Loss: 0.335396
Train epoch 3: [6000/18806 (31.9%)]	Loss: 0.336077
Train epoch 3: [7000/18806 (37.2%)]	Loss: 0.333799
Train epoch 3: [8000/18806 (42.5%)]	Loss: 0.333009
Train epoch 3: [9000/18806 (47.9%)]	Loss: 0.331974
Train epoch 3: [10000/18806 (53.2%)]	Loss: 0.332193
Train epoch 3: [11000/18806 (58.5%)]	Loss: 0.331033
Train epoch 3: [12000/18806 (63.8%)]	Loss: 0.330758
Train epoch 3: [13000/18806 (69.1%)]	Loss: 0.329677
Train epoch 3: [14000/18806 (74.4%)]	Loss: 0.329591
Train epoch 3: [15000/18806 (79.8%)]	Loss: 0.329077
Train epoch 3: [16000/18806 (85.1%)]	Loss: 0.329101
Train epoch 3: [17000/18806 (90.4%)]	Loss: 0.328700
Train epoch 3: [18000/18806 (95.7%)]	Loss: 0.328423
====> Epoch 3: Average train loss 0.327821 (['ihm: 0.359015', 'sdm1: 0.296628'])
====> Dev set loss: 0.298895 (['ihm: 0.304617', 'sdm1: 0.293173'])
New best dev set loss: 0.298895
Saved checkpoint for model
Train epoch 4: [1000/18806 (5.3%)]	Loss: 0.317402
Train epoch 4: [2000/18806 (10.6%)]	Loss: 0.323575
Train epoch 4: [3000/18806 (16.0%)]	Loss: 0.324471
Train epoch 4: [4000/18806 (21.3%)]	Loss: 0.322148
Train epoch 4: [5000/18806 (26.6%)]	Loss: 0.322578
Train epoch 4: [6000/18806 (31.9%)]	Loss: 0.322426
Train epoch 4: [7000/18806 (37.2%)]	Loss: 0.321057
Train epoch 4: [8000/18806 (42.5%)]	Loss: 0.320449
Train epoch 4: [9000/18806 (47.9%)]	Loss: 0.320550
Train epoch 4: [10000/18806 (53.2%)]	Loss: 0.320629
Train epoch 4: [11000/18806 (58.5%)]	Loss: 0.319832
Train epoch 4: [12000/18806 (63.8%)]	Loss: 0.320153
Train epoch 4: [13000/18806 (69.1%)]	Loss: 0.319372
Train epoch 4: [14000/18806 (74.4%)]	Loss: 0.319231
Train epoch 4: [15000/18806 (79.8%)]	Loss: 0.318678
Train epoch 4: [16000/18806 (85.1%)]	Loss: 0.319115
Train epoch 4: [17000/18806 (90.4%)]	Loss: 0.318560
Train epoch 4: [18000/18806 (95.7%)]	Loss: 0.318593
====> Epoch 4: Average train loss 0.318342 (['ihm: 0.348356', 'sdm1: 0.288328'])
====> Dev set loss: 0.278253 (['ihm: 0.290833', 'sdm1: 0.265673'])
New best dev set loss: 0.278253
Saved checkpoint for model
Train epoch 5: [1000/18806 (5.3%)]	Loss: 0.317511
Train epoch 5: [2000/18806 (10.6%)]	Loss: 0.316789
Train epoch 5: [3000/18806 (16.0%)]	Loss: 0.317613
Train epoch 5: [4000/18806 (21.3%)]	Loss: 0.317018
Train epoch 5: [5000/18806 (26.6%)]	Loss: 0.317916
Train epoch 5: [6000/18806 (31.9%)]	Loss: 0.317926
Train epoch 5: [7000/18806 (37.2%)]	Loss: 0.316701
Train epoch 5: [8000/18806 (42.5%)]	Loss: 0.316211
Train epoch 5: [9000/18806 (47.9%)]	Loss: 0.316411
Train epoch 5: [10000/18806 (53.2%)]	Loss: 0.316401
Train epoch 5: [11000/18806 (58.5%)]	Loss: 0.315820
Train epoch 5: [12000/18806 (63.8%)]	Loss: 0.315310
Train epoch 5: [13000/18806 (69.1%)]	Loss: 0.314767
Train epoch 5: [14000/18806 (74.4%)]	Loss: 0.314694
Train epoch 5: [15000/18806 (79.8%)]	Loss: 0.314309
Train epoch 5: [16000/18806 (85.1%)]	Loss: 0.314853
Train epoch 5: [17000/18806 (90.4%)]	Loss: 0.314223
Train epoch 5: [18000/18806 (95.7%)]	Loss: 0.313998
====> Epoch 5: Average train loss 0.313705 (['ihm: 0.342991', 'sdm1: 0.284420'])
====> Dev set loss: 0.277257 (['ihm: 0.291193', 'sdm1: 0.263322'])
New best dev set loss: 0.277257
Saved checkpoint for model
Train epoch 6: [1000/18806 (5.3%)]	Loss: 0.309163
Train epoch 6: [2000/18806 (10.6%)]	Loss: 0.310768
Train epoch 6: [3000/18806 (16.0%)]	Loss: 0.312548
Train epoch 6: [4000/18806 (21.3%)]	Loss: 0.311124
Train epoch 6: [5000/18806 (26.6%)]	Loss: 0.311176
Train epoch 6: [6000/18806 (31.9%)]	Loss: 0.310953
Train epoch 6: [7000/18806 (37.2%)]	Loss: 0.309806
Train epoch 6: [8000/18806 (42.5%)]	Loss: 0.309396
Train epoch 6: [9000/18806 (47.9%)]	Loss: 0.309704
Train epoch 6: [10000/18806 (53.2%)]	Loss: 0.309368
Train epoch 6: [11000/18806 (58.5%)]	Loss: 0.308715
Train epoch 6: [12000/18806 (63.8%)]	Loss: 0.308637
Train epoch 6: [13000/18806 (69.1%)]	Loss: 0.307864
Train epoch 6: [14000/18806 (74.4%)]	Loss: 0.307981
Train epoch 6: [15000/18806 (79.8%)]	Loss: 0.307898
Train epoch 6: [16000/18806 (85.1%)]	Loss: 0.308178
Train epoch 6: [17000/18806 (90.4%)]	Loss: 0.307668
Train epoch 6: [18000/18806 (95.7%)]	Loss: 0.307698
====> Epoch 6: Average train loss 0.307313 (['ihm: 0.336060', 'sdm1: 0.278565'])
====> Dev set loss: 0.274219 (['ihm: 0.289606', 'sdm1: 0.258831'])
New best dev set loss: 0.274219
Saved checkpoint for model
Train epoch 7: [1000/18806 (5.3%)]	Loss: 0.302209
Train epoch 7: [2000/18806 (10.6%)]	Loss: 0.304960
Train epoch 7: [3000/18806 (16.0%)]	Loss: 0.307181
Train epoch 7: [4000/18806 (21.3%)]	Loss: 0.304502
Train epoch 7: [5000/18806 (26.6%)]	Loss: 0.305093
Train epoch 7: [6000/18806 (31.9%)]	Loss: 0.305074
Train epoch 7: [7000/18806 (37.2%)]	Loss: 0.303537
Train epoch 7: [8000/18806 (42.5%)]	Loss: 0.302878
Train epoch 7: [9000/18806 (47.9%)]	Loss: 0.302939
Train epoch 7: [10000/18806 (53.2%)]	Loss: 0.303955
Train epoch 7: [11000/18806 (58.5%)]	Loss: 0.303186
Train epoch 7: [12000/18806 (63.8%)]	Loss: 0.302870
Train epoch 7: [13000/18806 (69.1%)]	Loss: 0.302220
Train epoch 7: [14000/18806 (74.4%)]	Loss: 0.302649
Train epoch 7: [15000/18806 (79.8%)]	Loss: 0.302198
Train epoch 7: [16000/18806 (85.1%)]	Loss: 0.302185
Train epoch 7: [17000/18806 (90.4%)]	Loss: 0.301912
Train epoch 7: [18000/18806 (95.7%)]	Loss: 0.301661
====> Epoch 7: Average train loss 0.301402 (['ihm: 0.329249', 'sdm1: 0.273556'])
====> Dev set loss: 0.270954 (['ihm: 0.289373', 'sdm1: 0.252535'])
New best dev set loss: 0.270954
Saved checkpoint for model
Train epoch 8: [1000/18806 (5.3%)]	Loss: 0.299122
Train epoch 8: [2000/18806 (10.6%)]	Loss: 0.300730
Train epoch 8: [3000/18806 (16.0%)]	Loss: 0.302000
Train epoch 8: [4000/18806 (21.3%)]	Loss: 0.299972
Train epoch 8: [5000/18806 (26.6%)]	Loss: 0.300112
Train epoch 8: [6000/18806 (31.9%)]	Loss: 0.299916
Train epoch 8: [7000/18806 (37.2%)]	Loss: 0.298657
Train epoch 8: [8000/18806 (42.5%)]	Loss: 0.298910
Train epoch 8: [9000/18806 (47.9%)]	Loss: 0.298164
Train epoch 8: [10000/18806 (53.2%)]	Loss: 0.298264
Train epoch 8: [11000/18806 (58.5%)]	Loss: 0.297881
Train epoch 8: [12000/18806 (63.8%)]	Loss: 0.297921
Train epoch 8: [13000/18806 (69.1%)]	Loss: 0.297235
Train epoch 8: [14000/18806 (74.4%)]	Loss: 0.297240
Train epoch 8: [15000/18806 (79.8%)]	Loss: 0.296927
Train epoch 8: [16000/18806 (85.1%)]	Loss: 0.297224
Train epoch 8: [17000/18806 (90.4%)]	Loss: 0.296860
Train epoch 8: [18000/18806 (95.7%)]	Loss: 0.296799
====> Epoch 8: Average train loss 0.296576 (['ihm: 0.323976', 'sdm1: 0.269176'])
====> Dev set loss: 0.259857 (['ihm: 0.280246', 'sdm1: 0.239468'])
New best dev set loss: 0.259857
Saved checkpoint for model
Train epoch 9: [1000/18806 (5.3%)]	Loss: 0.295263
Train epoch 9: [2000/18806 (10.6%)]	Loss: 0.298080
Train epoch 9: [3000/18806 (16.0%)]	Loss: 0.298201
Train epoch 9: [4000/18806 (21.3%)]	Loss: 0.296809
Train epoch 9: [5000/18806 (26.6%)]	Loss: 0.297360
Train epoch 9: [6000/18806 (31.9%)]	Loss: 0.297418
Train epoch 9: [7000/18806 (37.2%)]	Loss: 0.295791
Train epoch 9: [8000/18806 (42.5%)]	Loss: 0.295053
Train epoch 9: [9000/18806 (47.9%)]	Loss: 0.295125
Train epoch 9: [10000/18806 (53.2%)]	Loss: 0.295809
Train epoch 9: [11000/18806 (58.5%)]	Loss: 0.295219
Train epoch 9: [12000/18806 (63.8%)]	Loss: 0.294922
Train epoch 9: [13000/18806 (69.1%)]	Loss: 0.294358
Train epoch 9: [14000/18806 (74.4%)]	Loss: 0.294400
Train epoch 9: [15000/18806 (79.8%)]	Loss: 0.294209
Train epoch 9: [16000/18806 (85.1%)]	Loss: 0.294549
Train epoch 9: [17000/18806 (90.4%)]	Loss: 0.294195
Train epoch 9: [18000/18806 (95.7%)]	Loss: 0.294203
====> Epoch 9: Average train loss 0.294023 (['ihm: 0.321111', 'sdm1: 0.266934'])
====> Dev set loss: 0.261912 (['ihm: 0.281330', 'sdm1: 0.242494'])
No improvement in 1 epochs (best dev set loss: 0.259857)
Not saving checkpoint; no improvement made
Train epoch 10: [1000/18806 (5.3%)]	Loss: 0.289726
Train epoch 10: [2000/18806 (10.6%)]	Loss: 0.293609
Train epoch 10: [3000/18806 (16.0%)]	Loss: 0.294637
Train epoch 10: [4000/18806 (21.3%)]	Loss: 0.293763
Train epoch 10: [5000/18806 (26.6%)]	Loss: 0.293937
Train epoch 10: [6000/18806 (31.9%)]	Loss: 0.294289
Train epoch 10: [7000/18806 (37.2%)]	Loss: 0.293137
Train epoch 10: [8000/18806 (42.5%)]	Loss: 0.292869
Train epoch 10: [9000/18806 (47.9%)]	Loss: 0.292633
Train epoch 10: [10000/18806 (53.2%)]	Loss: 0.292685
Train epoch 10: [11000/18806 (58.5%)]	Loss: 0.292464
Train epoch 10: [12000/18806 (63.8%)]	Loss: 0.292609
Train epoch 10: [13000/18806 (69.1%)]	Loss: 0.292146
Train epoch 10: [14000/18806 (74.4%)]	Loss: 0.292370
Train epoch 10: [15000/18806 (79.8%)]	Loss: 0.292026
Train epoch 10: [16000/18806 (85.1%)]	Loss: 0.292267
Train epoch 10: [17000/18806 (90.4%)]	Loss: 0.291973
Train epoch 10: [18000/18806 (95.7%)]	Loss: 0.292018
====> Epoch 10: Average train loss 0.291868 (['ihm: 0.318811', 'sdm1: 0.264925'])
====> Dev set loss: 0.269955 (['ihm: 0.293422', 'sdm1: 0.246488'])
No improvement in 2 epochs (best dev set loss: 0.259857)
Not saving checkpoint; no improvement made
Train epoch 11: [1000/18806 (5.3%)]	Loss: 0.288648
Train epoch 11: [2000/18806 (10.6%)]	Loss: 0.292886
Train epoch 11: [3000/18806 (16.0%)]	Loss: 0.293260
Train epoch 11: [4000/18806 (21.3%)]	Loss: 0.291727
Train epoch 11: [5000/18806 (26.6%)]	Loss: 0.292355
Train epoch 11: [6000/18806 (31.9%)]	Loss: 0.292535
Train epoch 11: [7000/18806 (37.2%)]	Loss: 0.291223
Train epoch 11: [8000/18806 (42.5%)]	Loss: 0.290934
Train epoch 11: [9000/18806 (47.9%)]	Loss: 0.290804
Train epoch 11: [10000/18806 (53.2%)]	Loss: 0.291147
Train epoch 11: [11000/18806 (58.5%)]	Loss: 0.290800
Train epoch 11: [12000/18806 (63.8%)]	Loss: 0.290895
Train epoch 11: [13000/18806 (69.1%)]	Loss: 0.290445
Train epoch 11: [14000/18806 (74.4%)]	Loss: 0.290699
Train epoch 11: [15000/18806 (79.8%)]	Loss: 0.290606
Train epoch 11: [16000/18806 (85.1%)]	Loss: 0.290808
Train epoch 11: [17000/18806 (90.4%)]	Loss: 0.290415
Train epoch 11: [18000/18806 (95.7%)]	Loss: 0.290485
====> Epoch 11: Average train loss 0.290341 (['ihm: 0.317030', 'sdm1: 0.263651'])
====> Dev set loss: 0.259876 (['ihm: 0.278554', 'sdm1: 0.241198'])
No improvement in 3 epochs (best dev set loss: 0.259857)
STOPPING EARLY
Computing reconstruction loss...
Loaded checkpoint; best model ready now.
====> Training set reconstruction loss: 0.263183 (['ihm: 0.278607', 'sdm1: 0.247760'])
====> Dev set reconstruction loss: 0.259857 (['ihm: 0.280246', 'sdm1: 0.239468'])
Trained convolutional variational multidecoder.
