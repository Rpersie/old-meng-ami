Setting up environment...
Environment set up.
Training convolutional multidecoder...
Constructing model...
Done constructing model.
CNNMultidecoder (
  (encoder_conv): Sequential (
    (conv2d_0): Conv2d(1, 256, kernel_size=(3, 3), stride=(1, 1))
    (ELU_0): ELU (alpha=1.0)
    (maxpool2d_0): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
    (conv2d_1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1))
    (ELU_1): ELU (alpha=1.0)
    (maxpool2d_1): MaxPool2d (size=(1, 3), stride=(1, 3), dilation=(1, 1))
  )
  (encoder_fc): Sequential (
    (lin_0): Linear (14336 -> 2048)
    (ELU_0): ELU (alpha=1.0)
    (lin_final): Linear (2048 -> 1024)
    (ELU_final): ELU (alpha=1.0)
  )
  (decoder_fc_ihm): Sequential (
    (lin_0): Linear (1024 -> 2048)
    (ELU_0): ELU (alpha=1.0)
    (lin_final): Linear (2048 -> 14336)
    (ELU_final): ELU (alpha=1.0)
  )
  (decoder_deconv_ihm): Sequential (
    (maxunpool2d_0): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ELU_0): ELU (alpha=1.0)
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(256, 1, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ELU_1): ELU (alpha=1.0)
  )
  (decoder_fc_sdm1): Sequential (
    (lin_0): Linear (1024 -> 2048)
    (ELU_0): ELU (alpha=1.0)
    (lin_final): Linear (2048 -> 14336)
    (ELU_final): ELU (alpha=1.0)
  )
  (decoder_deconv_sdm1): Sequential (
    (maxunpool2d_0): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_0): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ELU_0): ELU (alpha=1.0)
    (maxunpool2d_1): MaxUnpool2d (size=(1, 3), stride=(1, 3), padding=(0, 0))
    (conv2d_1): Conv2d(256, 1, kernel_size=(3, 3), stride=(1, 1), padding=(2, 2))
    (ELU_1): ELU (alpha=1.0)
  )
)
Setting up data...
Setting up training datasets...
Using 2407138 training features (9403 batches) for class ihm
Using 2407138 training features (9403 batches) for class sdm1
Setting up dev datasets...
Using 249565 dev features (975 batches) for class ihm
Using 249565 dev features (975 batches) for class sdm1
Setting up minibatch shuffling for training...
18806 total batches: {'ihm': 9403, 'sdm1': 9403}
Done setting up data.
Starting training!
Train epoch 1: [1000/18806 (5.3%)]	Loss: 0.258243
Train epoch 1: [2000/18806 (10.6%)]	Loss: 0.190207
Train epoch 1: [3000/18806 (16.0%)]	Loss: 0.155988
Train epoch 1: [4000/18806 (21.3%)]	Loss: 0.137774
Train epoch 1: [5000/18806 (26.6%)]	Loss: 0.125722
Train epoch 1: [6000/18806 (31.9%)]	Loss: 0.117366
Train epoch 1: [7000/18806 (37.2%)]	Loss: 0.109920
Train epoch 1: [8000/18806 (42.5%)]	Loss: 0.104318
Train epoch 1: [9000/18806 (47.9%)]	Loss: 0.100563
Train epoch 1: [10000/18806 (53.2%)]	Loss: 0.096594
Train epoch 1: [11000/18806 (58.5%)]	Loss: 0.093850
Train epoch 1: [12000/18806 (63.8%)]	Loss: 0.091047
Train epoch 1: [13000/18806 (69.1%)]	Loss: 0.088470
Train epoch 1: [14000/18806 (74.4%)]	Loss: 0.086202
Train epoch 1: [15000/18806 (79.8%)]	Loss: 0.084496
Train epoch 1: [16000/18806 (85.1%)]	Loss: 0.082677
Train epoch 1: [17000/18806 (90.4%)]	Loss: 0.081247
Train epoch 1: [18000/18806 (95.7%)]	Loss: 0.080027
====> Epoch 1: Average train loss 0.078860 (['ihm: 0.085525', 'sdm1: 0.072195'])
====> Dev set loss: 0.051200 (['ihm: 0.054851', 'sdm1: 0.047550'])
New best dev set loss: 0.051200
Saved checkpoint for model
Train epoch 2: [1000/18806 (5.3%)]	Loss: 0.054332
Train epoch 2: [2000/18806 (10.6%)]	Loss: 0.058237
Train epoch 2: [3000/18806 (16.0%)]	Loss: 0.058225
Train epoch 2: [4000/18806 (21.3%)]	Loss: 0.056900
Train epoch 2: [5000/18806 (26.6%)]	Loss: 0.056391
Train epoch 2: [6000/18806 (31.9%)]	Loss: 0.055367
Train epoch 2: [7000/18806 (37.2%)]	Loss: 0.054568
Train epoch 2: [8000/18806 (42.5%)]	Loss: 0.053931
Train epoch 2: [9000/18806 (47.9%)]	Loss: 0.053915
Train epoch 2: [10000/18806 (53.2%)]	Loss: 0.053670
Train epoch 2: [11000/18806 (58.5%)]	Loss: 0.053392
Train epoch 2: [12000/18806 (63.8%)]	Loss: 0.053077
Train epoch 2: [13000/18806 (69.1%)]	Loss: 0.052616
Train epoch 2: [14000/18806 (74.4%)]	Loss: 0.052221
Train epoch 2: [15000/18806 (79.8%)]	Loss: 0.052088
Train epoch 2: [16000/18806 (85.1%)]	Loss: 0.051976
Train epoch 2: [17000/18806 (90.4%)]	Loss: 0.051998
Train epoch 2: [18000/18806 (95.7%)]	Loss: 0.052047
====> Epoch 2: Average train loss 0.051822 (['ihm: 0.060159', 'sdm1: 0.043485'])
====> Dev set loss: 0.043459 (['ihm: 0.050879', 'sdm1: 0.036039'])
New best dev set loss: 0.043459
Saved checkpoint for model
Train epoch 3: [1000/18806 (5.3%)]	Loss: 0.048038
Train epoch 3: [2000/18806 (10.6%)]	Loss: 0.050716
Train epoch 3: [3000/18806 (16.0%)]	Loss: 0.050027
Train epoch 3: [4000/18806 (21.3%)]	Loss: 0.049887
Train epoch 3: [5000/18806 (26.6%)]	Loss: 0.049716
Train epoch 3: [6000/18806 (31.9%)]	Loss: 0.049056
Train epoch 3: [7000/18806 (37.2%)]	Loss: 0.048593
Train epoch 3: [8000/18806 (42.5%)]	Loss: 0.048459
Train epoch 3: [9000/18806 (47.9%)]	Loss: 0.048674
Train epoch 3: [10000/18806 (53.2%)]	Loss: 0.048459
Train epoch 3: [11000/18806 (58.5%)]	Loss: 0.048249
Train epoch 3: [12000/18806 (63.8%)]	Loss: 0.048283
Train epoch 3: [13000/18806 (69.1%)]	Loss: 0.047948
Train epoch 3: [14000/18806 (74.4%)]	Loss: 0.047702
Train epoch 3: [15000/18806 (79.8%)]	Loss: 0.047688
Train epoch 3: [16000/18806 (85.1%)]	Loss: 0.047621
Train epoch 3: [17000/18806 (90.4%)]	Loss: 0.047548
Train epoch 3: [18000/18806 (95.7%)]	Loss: 0.047859
====> Epoch 3: Average train loss 0.047730 (['ihm: 0.056769', 'sdm1: 0.038691'])
====> Dev set loss: 0.048193 (['ihm: 0.055713', 'sdm1: 0.040673'])
No improvement in 1 epochs (best dev set loss: 0.043459)
Not saving checkpoint; no improvement made
Train epoch 4: [1000/18806 (5.3%)]	Loss: 0.046167
Train epoch 4: [2000/18806 (10.6%)]	Loss: 0.049629
Train epoch 4: [3000/18806 (16.0%)]	Loss: 0.048644
Train epoch 4: [4000/18806 (21.3%)]	Loss: 0.049286
Train epoch 4: [5000/18806 (26.6%)]	Loss: 0.048821
Train epoch 4: [6000/18806 (31.9%)]	Loss: 0.047666
Train epoch 4: [7000/18806 (37.2%)]	Loss: 0.047289
Train epoch 4: [8000/18806 (42.5%)]	Loss: 0.047004
Train epoch 4: [9000/18806 (47.9%)]	Loss: 0.047107
Train epoch 4: [10000/18806 (53.2%)]	Loss: 0.046946
Train epoch 4: [11000/18806 (58.5%)]	Loss: 0.046901
Train epoch 4: [12000/18806 (63.8%)]	Loss: 0.046964
Train epoch 4: [13000/18806 (69.1%)]	Loss: 0.046670
Train epoch 4: [14000/18806 (74.4%)]	Loss: 0.046477
Train epoch 4: [15000/18806 (79.8%)]	Loss: 0.046367
Train epoch 4: [16000/18806 (85.1%)]	Loss: 0.046270
Train epoch 4: [17000/18806 (90.4%)]	Loss: 0.046542
Train epoch 4: [18000/18806 (95.7%)]	Loss: 0.046741
====> Epoch 4: Average train loss 0.046732 (['ihm: 0.055849', 'sdm1: 0.037615'])
====> Dev set loss: 0.039835 (['ihm: 0.047142', 'sdm1: 0.032528'])
New best dev set loss: 0.039835
Saved checkpoint for model
Train epoch 5: [1000/18806 (5.3%)]	Loss: 0.044368
Train epoch 5: [2000/18806 (10.6%)]	Loss: 0.046894
Train epoch 5: [3000/18806 (16.0%)]	Loss: 0.046756
Train epoch 5: [4000/18806 (21.3%)]	Loss: 0.046487
Train epoch 5: [5000/18806 (26.6%)]	Loss: 0.046617
Train epoch 5: [6000/18806 (31.9%)]	Loss: 0.045871
Train epoch 5: [7000/18806 (37.2%)]	Loss: 0.045650
Train epoch 5: [8000/18806 (42.5%)]	Loss: 0.045618
Train epoch 5: [9000/18806 (47.9%)]	Loss: 0.045978
Train epoch 5: [10000/18806 (53.2%)]	Loss: 0.045881
Train epoch 5: [11000/18806 (58.5%)]	Loss: 0.046124
Train epoch 5: [12000/18806 (63.8%)]	Loss: 0.045974
Train epoch 5: [13000/18806 (69.1%)]	Loss: 0.045710
Train epoch 5: [14000/18806 (74.4%)]	Loss: 0.045646
Train epoch 5: [15000/18806 (79.8%)]	Loss: 0.045628
Train epoch 5: [16000/18806 (85.1%)]	Loss: 0.045602
Train epoch 5: [17000/18806 (90.4%)]	Loss: 0.045470
Train epoch 5: [18000/18806 (95.7%)]	Loss: 0.045718
====> Epoch 5: Average train loss 0.045714 (['ihm: 0.055068', 'sdm1: 0.036360'])
====> Dev set loss: 0.041922 (['ihm: 0.048649', 'sdm1: 0.035194'])
No improvement in 1 epochs (best dev set loss: 0.039835)
Not saving checkpoint; no improvement made
Train epoch 6: [1000/18806 (5.3%)]	Loss: 0.045111
Train epoch 6: [2000/18806 (10.6%)]	Loss: 0.047151
Train epoch 6: [3000/18806 (16.0%)]	Loss: 0.046317
Train epoch 6: [4000/18806 (21.3%)]	Loss: 0.046254
Train epoch 6: [5000/18806 (26.6%)]	Loss: 0.046269
Train epoch 6: [6000/18806 (31.9%)]	Loss: 0.045649
Train epoch 6: [7000/18806 (37.2%)]	Loss: 0.045293
Train epoch 6: [8000/18806 (42.5%)]	Loss: 0.045401
Train epoch 6: [9000/18806 (47.9%)]	Loss: 0.045613
Train epoch 6: [10000/18806 (53.2%)]	Loss: 0.045440
Train epoch 6: [11000/18806 (58.5%)]	Loss: 0.045479
Train epoch 6: [12000/18806 (63.8%)]	Loss: 0.045348
Train epoch 6: [13000/18806 (69.1%)]	Loss: 0.045080
Train epoch 6: [14000/18806 (74.4%)]	Loss: 0.044928
Train epoch 6: [15000/18806 (79.8%)]	Loss: 0.045021
Train epoch 6: [16000/18806 (85.1%)]	Loss: 0.044975
Train epoch 6: [17000/18806 (90.4%)]	Loss: 0.044874
Train epoch 6: [18000/18806 (95.7%)]	Loss: 0.045102
====> Epoch 6: Average train loss 0.045090 (['ihm: 0.054456', 'sdm1: 0.035724'])
====> Dev set loss: 0.038806 (['ihm: 0.045854', 'sdm1: 0.031758'])
New best dev set loss: 0.038806
Saved checkpoint for model
